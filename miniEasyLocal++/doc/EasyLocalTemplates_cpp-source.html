<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <title>EasyLocal++ Documentation</title>
  <link href="local.css" rel="stylesheet" type="text/css">
</head>

<body lang="en">

<table width="100%" border="0">
  <tbody>
    <tr>
      <td colspan="2"><h1 class="nojustify">EasyLocal++ Documentation</h1>
        <hr>
      </td>
    </tr>
    <tr>
      <td width="30" align="center">&nbsp;</td>
      <td>
<!-- Generated by Doxygen 1.2.5 on Sat Jun 9 18:59:15 2001 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>EasyLocalTemplates.cpp</h1><a href="EasyLocalTemplates_cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00017 <font class="keyword">namespace </font>easylocal {
00018 
00019   <font class="comment">// State Manager functions</font>
00020 
00028   template &lt;class Input, class State&gt;
<a name="l00029"></a><a class="code" href="class_easylocal__StateManager.html#a2">00029</a>   fvalue StateManager&lt;Input,State&gt;::SampleState(State &amp;st, <font class="keywordtype">int</font> samples)<font class="keyword"></font>
00030 <font class="keyword">  </font>{ 
00031     <font class="keywordtype">int</font> s = 1;
00032     <a class="code" href="class_easylocal__StateManager.html#a0">RandomState</a>(st);
00033     fvalue cost = <a class="code" href="class_easylocal__StateManager.html#a4">CostFunction</a>(st);
00034     State best_state = st;
00035     fvalue best_cost = cost;
00036     <font class="keywordflow">while</font> (s &lt; samples)
00037       { 
00038         <a class="code" href="class_easylocal__StateManager.html#a0">RandomState</a>(st);
00039         cost = <a class="code" href="class_easylocal__StateManager.html#a4">CostFunction</a>(st);
00040         <font class="keywordflow">if</font> (cost &lt; best_cost)
00041           { 
00042             best_state = st;
00043             best_cost = cost;
00044           }
00045         s++;
00046       }
00047     st = best_state;
00048     <font class="keywordflow">return</font> best_cost;
00049   }
00050 
00060   template &lt;class Input, class State&gt;
<a name="l00061"></a><a class="code" href="class_easylocal__StateManager.html#a3">00061</a>   fvalue StateManager&lt;Input,State&gt;::ImprovedSampleState(State &amp;st, <font class="keywordtype">int</font> samples, Runner&lt;Input,State&gt;* r)<font class="keyword"></font>
00062 <font class="keyword">  </font>{ <font class="comment">// same of SampleState, except that each sample is let run using r</font>
00063     <font class="comment">// before comparing its value</font>
00064     <font class="keywordtype">int</font> s = 1;
00065     <a class="code" href="class_easylocal__StateManager.html#a0">RandomState</a>(st);
00066     r-&gt;SetCurrentState(st);
00067     r-&gt;Go();
00068     st = r-&gt;GetCurrentState();
00069     fvalue cost = <a class="code" href="class_easylocal__StateManager.html#a4">CostFunction</a>(st);
00070     State best_state = st;
00071     fvalue best_cost = cost;
00072     <font class="keywordflow">do</font> 
00073       { 
00074         cost = <a class="code" href="class_easylocal__StateManager.html#a4">CostFunction</a>(st);
00075         <font class="keywordflow">if</font> (cost &lt; best_cost)
00076           { 
00077             best_state = st;
00078             best_cost = cost;
00079           }
00080         <a class="code" href="class_easylocal__StateManager.html#a0">RandomState</a>(st);
00081         r-&gt;SetCurrentState(st);
00082         r-&gt;Go();
00083         st = r-&gt;GetCurrentState();
00084         s++;
00085       }
00086     <font class="keywordflow">while</font> (s &lt;= samples);
00087     st = best_state;
00088     <font class="keywordflow">return</font> best_cost;
00089   }
00090 
00098   template &lt;class Input, class State&gt;
<a name="l00099"></a><a class="code" href="class_easylocal__StateManager.html#a4">00099</a>   fvalue StateManager&lt;Input,State&gt;::CostFunction(<font class="keyword">const</font> State&amp; st)<font class="keyword"> const </font>
00100 <font class="keyword">  </font>{ <font class="keywordflow">return</font> HARD_WEIGHT * <a class="code" href="class_easylocal__StateManager.html#a6">Violations</a>(st) + <a class="code" href="class_easylocal__StateManager.html#a5">Objective</a>(st); } 
00101 
00107   template &lt;class Input, class State&gt;
<a name="l00108"></a><a class="code" href="class_easylocal__StateManager.html#a7">00108</a>   <font class="keywordtype">void</font> StateManager&lt;Input,State&gt;::PrintState(<font class="keyword">const</font> State&amp; st)<font class="keyword"> const</font>
00109 <font class="keyword">  </font>{
00110     std::cout &lt;&lt; st &lt;&lt; std::endl;
00111     std::cout &lt;&lt; <font class="stringliteral">"Total cost : "</font> &lt;&lt; <a class="code" href="class_easylocal__StateManager.html#a4">CostFunction</a>(st) &lt;&lt; std::endl;
00112     std::cout &lt;&lt; <font class="stringliteral">"    Violations : "</font> &lt;&lt; <a class="code" href="class_easylocal__StateManager.html#a6">Violations</a>(st) &lt;&lt; std::endl;
00113     std::cout &lt;&lt; <font class="stringliteral">"    Objective : "</font> &lt;&lt; <a class="code" href="class_easylocal__StateManager.html#a5">Objective</a>(st) &lt;&lt; std::endl;
00114   }
00115 
00123   template &lt;class Input, class State&gt;  
<a name="l00124"></a><a class="code" href="class_easylocal__StateManager.html#a6">00124</a>   fvalue StateManager&lt;Input,State&gt;::Violations(<font class="keyword">const</font> State&amp; st)<font class="keyword"> const</font>
00125 <font class="keyword">  </font>{ 
00126     std::cout &lt;&lt; <font class="stringliteral">"Warning: violations function not implemented yet!"</font> &lt;&lt; std::endl;
00127     <font class="keywordflow">return</font> 0; 
00128   }
00129 
00137   template &lt;class Input, class State&gt;  
<a name="l00138"></a><a class="code" href="class_easylocal__StateManager.html#a5">00138</a>   fvalue StateManager&lt;Input,State&gt;::Objective(<font class="keyword">const</font> State&amp; st)<font class="keyword"> const</font>
00139 <font class="keyword">  </font>{ 
00140     std::cout &lt;&lt; <font class="stringliteral">"Warning: violations function not implemented yet!"</font> &lt;&lt; std::endl;
00141     <font class="keywordflow">return</font> 0; 
00142   }
00143  
00149   template &lt;class Input, class State&gt;  
<a name="l00150"></a><a class="code" href="class_easylocal__StateManager.html#a9">00150</a>   <font class="keywordtype">void</font> StateManager&lt;Input,State&gt;::SetInput(Input* in)<font class="keyword"> </font>
00151 <font class="keyword">  </font>{ p_in = in; }
00152 
00158   template &lt;class Input, class State&gt;  
<a name="l00159"></a><a class="code" href="class_easylocal__StateManager.html#a10">00159</a>   Input* StateManager&lt;Input,State&gt;::GetInput()<font class="keyword"> </font>
00160 <font class="keyword">  </font>{ <font class="keywordflow">return</font> p_in; }
00161 
00166   template &lt;class Input, class State&gt;  
<a name="l00167"></a><a class="code" href="class_easylocal__StateManager.html#a8">00167</a>   <font class="keywordtype">void</font> StateManager&lt;Input,State&gt;::Check()<font class="keyword"> const</font>
00168 <font class="keyword">  </font>{ assert(p_in != NULL); }
00169 
00175   template &lt;class Input, class State&gt;  
<a name="l00176"></a><a class="code" href="class_easylocal__StateManager.html#b0">00176</a>   StateManager&lt;Input,State&gt;::StateManager(Input* in) 
00177     : p_in(in)  
00178   {}
00179 
00180   <font class="comment">// Output Manager functions</font>
00181 
00182 
00189   template &lt;class Input, class Output, class State&gt;
<a name="l00190"></a><a class="code" href="class_easylocal__OutputManager.html#a2">00190</a>   <font class="keywordtype">void</font> OutputManager&lt;Input,Output,State&gt;::ReadState(State &amp;st, std::istream &amp;is)<font class="keyword"> const</font>
00191 <font class="keyword">  </font>{
00192     Output out(p_in);
00193     is &gt;&gt; out;
00194     <a class="code" href="class_easylocal__OutputManager.html#a1">InputState</a>(st,out);
00195   }
00196 
00203   template &lt;class Input, class Output, class State&gt;
<a name="l00204"></a><a class="code" href="class_easylocal__OutputManager.html#a3">00204</a>   <font class="keywordtype">void</font> OutputManager&lt;Input,Output,State&gt;::WriteState(<font class="keyword">const</font> State &amp;st, std::ostream &amp;os)<font class="keyword"> const</font>
00205 <font class="keyword">  </font>{
00206     Output out(p_in);
00207     <a class="code" href="class_easylocal__OutputManager.html#a0">OutputState</a>(st,out);  
00208     os &lt;&lt; out;
00209   }
00210 
00216   template &lt;class Input, class Output, class State&gt;
<a name="l00217"></a><a class="code" href="class_easylocal__OutputManager.html#a5">00217</a>   <font class="keywordtype">void</font> OutputManager&lt;Input,Output,State&gt;::SetInput(Input* in)<font class="keyword"> </font>
00218 <font class="keyword">  </font>{ p_in = in; }
00219 
00225   template &lt;class Input, class Output, class State&gt;
<a name="l00226"></a><a class="code" href="class_easylocal__OutputManager.html#a6">00226</a>   Input* OutputManager&lt;Input,Output,State&gt;::GetInput()<font class="keyword"> </font>
00227 <font class="keyword">  </font>{ <font class="keywordflow">return</font> p_in; }
00228   
00233   template &lt;class Input, class Output, class State&gt;  
<a name="l00234"></a><a class="code" href="class_easylocal__OutputManager.html#a4">00234</a>   <font class="keywordtype">void</font> OutputManager&lt;Input,Output,State&gt;::Check()<font class="keyword"> const</font>
00235 <font class="keyword">  </font>{ 
00236     assert(p_in != NULL &amp;&amp; p_sm-&gt;GetInput() == p_in); 
00237   }
00238 
00239   <font class="comment">// Prohibition Manager functions</font>
00240   <font class="comment">// up to now, the only actual prohibition manager is the tabu list manager</font>
00241 
00249   template &lt;class Move&gt;
<a name="l00250"></a><a class="code" href="class_easylocal__TabuListManager.html#b0">00250</a>   TabuListManager&lt;Move&gt;::TabuListManager(<font class="keywordtype">int</font> min, <font class="keywordtype">int</font> max)
00251     : min_tenure(min), max_tenure(max), iter(0)
00252   { }
00253 
00254   
00262   template &lt;class Move&gt;
<a name="l00263"></a><a class="code" href="class_easylocal__TabuListManager.html#a0">00263</a>   <font class="keywordtype">void</font> TabuListManager&lt;Move&gt;::InsertMove(<font class="keyword">const</font> Move&amp; mv, fvalue mv_cost, fvalue curr, fvalue best)<font class="keyword"></font>
00264 <font class="keyword">  </font>{ 
00265     <a class="code" href="class_easylocal__TabuListManager.html#b3">InsertIntoList</a>(mv); 
00266     <a class="code" href="class_easylocal__TabuListManager.html#b4">UpdateAspirationFunction</a>(mv_cost,curr,best); 
00267   }
00268 
00278   template &lt;class Move&gt;
<a name="l00279"></a><a class="code" href="class_easylocal__TabuListManager.html#a1">00279</a>   <font class="keywordtype">bool</font> TabuListManager&lt;Move&gt;::ProhibitedMove(<font class="keyword">const</font> Move&amp; mv, fvalue mv_cost, fvalue curr, fvalue best)<font class="keyword"> const</font>
00280 <font class="keyword">  </font>{ <font class="keywordflow">return</font> <a class="code" href="class_easylocal__TabuListManager.html#b5">ListMember</a>(mv) &amp;&amp; !<a class="code" href="class_easylocal__TabuListManager.html#b2">Aspiration</a>(mv,mv_cost,curr,best); }
00281 
00285   template &lt;class Move&gt;
<a name="l00286"></a><a class="code" href="class_easylocal__TabuListManager.html#a3">00286</a>   <font class="keywordtype">void</font> TabuListManager&lt;Move&gt;::Clean()<font class="keyword"></font>
00287 <font class="keyword">  </font>{ tlist.clear(); }
00288 
00296   template &lt;class Move&gt;
<a name="l00297"></a><a class="code" href="class_easylocal__TabuListManager.html#b5">00297</a>   <font class="keywordtype">bool</font> TabuListManager&lt;Move&gt;::ListMember(<font class="keyword">const</font> Move&amp; mv)<font class="keyword"> const</font>
00298 <font class="keyword">  </font>{
00299     std::list&lt;ListItem&lt;Move&gt; &gt;::const_iterator p = tlist.begin();
00300     <font class="keywordflow">while</font> (p != tlist.end())
00301       {
00302         <font class="keywordflow">if</font> (<a class="code" href="class_easylocal__TabuListManager.html#a6">Inverse</a>(mv,p-&gt;elem))
00303           <font class="keywordflow">return</font> <font class="keyword">true</font>;
00304         <font class="keywordflow">else</font>
00305           p++;
00306       }
00307     <font class="keywordflow">return</font> <font class="keyword">false</font>;
00308   }
00309 
00316   template &lt;class Move&gt;
<a name="l00317"></a><a class="code" href="namespace_easylocal.html#a5">00317</a>   std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, const TabuListManager&lt;Move&gt;&amp; tl)
00318   {
00319     std::list&lt;ListItem&lt;Move&gt; &gt;::const_iterator p = tl.tlist.begin();
00320     <font class="keywordflow">while</font> (p != tl.tlist.end())
00321       {
00322         os &lt;&lt; p-&gt;elem &lt;&lt; <font class="stringliteral">" ("</font> &lt;&lt; p-&gt;out_iter - tl.iter &lt;&lt; <font class="stringliteral">")"</font> &lt;&lt; std::endl;
00323         p++;
00324       }
00325     <font class="keywordflow">return</font> os;
00326   }
00327 
00339   template &lt;class Move&gt;
<a name="l00340"></a><a class="code" href="class_easylocal__TabuListManager.html#b2">00340</a>   <font class="keywordtype">bool</font> TabuListManager&lt;Move&gt;::Aspiration(<font class="keyword">const</font> Move&amp; mv, fvalue mv_cost, fvalue curr, fvalue best)<font class="keyword"> const </font>
00341 <font class="keyword">  </font>{ <font class="keywordflow">return</font> curr + mv_cost &lt; best; }
00342 
00349   template &lt;class Move&gt;
<a name="l00350"></a><a class="code" href="class_easylocal__TabuListManager.html#b3">00350</a>   <font class="keywordtype">void</font> TabuListManager&lt;Move&gt;::InsertIntoList(<font class="keyword">const</font> Move&amp; mv)<font class="keyword"></font>
00351 <font class="keyword">  </font>{
00352     <font class="keywordtype">int</font> tenure = <a class="code" href="namespace_easylocal.html#a3">Random</a>(min_tenure,max_tenure);
00353     ListItem&lt;Move&gt; li(mv, iter+tenure);
00354     tlist.push_front(li);
00355         
00356     std::list&lt;ListItem&lt;Move&gt; &gt;::iterator p = tlist.begin();
00357     <font class="keywordflow">while</font> (p != tlist.end())
00358       <font class="keywordflow">if</font> (p-&gt;out_iter == iter)
00359         p = tlist.erase(p);
00360       <font class="keywordflow">else</font>
00361         p++;
00362     iter++;
00363   }
00364 
00365   <font class="comment">// Neighborhood explorer functions</font>
00366 
00374   template &lt;class Input, class State, class Move&gt;  
<a name="l00375"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#b0">00375</a>   NeighborhoodExplorer&lt;Input,State,Move&gt;::NeighborhoodExplorer(StateManager&lt;Input,State&gt;* sm, Input* in) 
00376     :  p_sm(sm), p_in(in), p_pm(NULL)
00377   {}
00378 
00388   template &lt;class Input, class State, class Move&gt;  
<a name="l00389"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#b1">00389</a>   NeighborhoodExplorer&lt;Input,State,Move&gt;::NeighborhoodExplorer(StateManager&lt;Input,State&gt;* sm, ProhibitionManager&lt;Move&gt;* pm, Input* in) 
00390     :  p_sm(sm), p_in(in), p_pm(pm)
00391   {}
00392 
00403   template &lt;class Input, class State, class Move&gt;  
<a name="l00404"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#a12">00404</a>   fvalue NeighborhoodExplorer&lt;Input,State,Move&gt;::DeltaCostFunction(<font class="keyword">const</font> State&amp; st, <font class="keyword">const</font> Move &amp; mv)<font class="keyword"></font>
00405 <font class="keyword">  </font>{ <font class="keywordflow">return</font> HARD_WEIGHT * <a class="code" href="class_easylocal__NeighborhoodExplorer.html#b3">DeltaViolations</a>(st,mv) + <a class="code" href="class_easylocal__NeighborhoodExplorer.html#b2">DeltaObjective</a>(st,mv); }
00406 
00412   template &lt;class Input, class State, class Move&gt;  
<a name="l00413"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#a10">00413</a>   <font class="keywordtype">void</font> NeighborhoodExplorer&lt;Input,State,Move&gt;::SetProhibitionManager(ProhibitionManager&lt;Move&gt;* pm)<font class="keyword"> </font>
00414 <font class="keyword">  </font>{ p_pm = pm; }
00415 
00416 
00426   template &lt;class Input, class State, class Move&gt;  
<a name="l00427"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#a4">00427</a>   fvalue NeighborhoodExplorer&lt;Input,State,Move&gt;::BestMove(<font class="keyword">const</font> State &amp;st, Move&amp; mv)<font class="keyword"></font>
00428 <font class="keyword">  </font>{  
00429     <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a1">FirstMove</a>(st,mv); 
00430     fvalue mv_cost = <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a12">DeltaCostFunction</a>(st,mv);
00431     best_move = mv; 
00432     fvalue best_delta = mv_cost;
00433     <font class="keywordflow">do</font> <font class="comment">// look for the best move</font>
00434       { 
00435         mv_cost = <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a12">DeltaCostFunction</a>(st,mv);
00436 <font class="preprocessor">#ifdef COST_DEBUG</font>
00437 <font class="preprocessor"></font>        std::cerr &lt;&lt; mv &lt;&lt; <font class="charliteral">' '</font> &lt;&lt; mv_cost &lt;&lt; std::endl;
00438 <font class="preprocessor">#endif</font>
00439 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (mv_cost &lt; best_delta) 
00440           { 
00441             best_move = mv;
00442             best_delta = mv_cost;
00443           }
00444         <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a2">NextMove</a>(st,mv);
00445       }
00446     <font class="keywordflow">while</font> (!<a class="code" href="class_easylocal__NeighborhoodExplorer.html#a8">LastMoveDone</a>(mv));
00447     mv = best_move;
00448     <font class="keywordflow">return</font> best_delta;
00449   }
00450 
00458   template &lt;class Input, class State, class Move&gt;  
<a name="l00459"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#a13">00459</a>   <font class="keywordtype">void</font> NeighborhoodExplorer&lt;Input,State,Move&gt;::NeighborhoodStatistics(<font class="keyword">const</font> State &amp;st)<font class="keyword"></font>
00460 <font class="keyword">  </font>{  
00461     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> neighbors = 0, improving_neighbors = 0, 
00462       worsening_neighbors = 0, non_improving_neighbors = 0;
00463     Move mv;
00464     fvalue mv_cost;
00465 
00466     <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a1">FirstMove</a>(st,mv);
00467     <font class="keywordflow">do</font> 
00468       {         
00469         neighbors++;
00470         mv_cost = <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a12">DeltaCostFunction</a>(st,mv);
00471         <font class="keywordflow">if</font> (mv_cost &lt; 0)
00472           improving_neighbors++;
00473         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (mv_cost &gt; 0)
00474           worsening_neighbors++;
00475         <font class="keywordflow">else</font>
00476           non_improving_neighbors++;
00477         <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a2">NextMove</a>(st,mv);
00478       }
00479     <font class="keywordflow">while</font> (!<a class="code" href="class_easylocal__NeighborhoodExplorer.html#a8">LastMoveDone</a>(mv));
00480     std::cout &lt;&lt; <font class="stringliteral">"Neighborhood size: "</font> &lt;&lt;  neighbors &lt;&lt; std::endl
00481               &lt;&lt; <font class="stringliteral">"   improving moves: "</font> &lt;&lt; improving_neighbors &lt;&lt; <font class="stringliteral">" ("</font>
00482               &lt;&lt; (100.0*improving_neighbors)/neighbors &lt;&lt; <font class="stringliteral">"\%)"</font> &lt;&lt; std::endl
00483               &lt;&lt; <font class="stringliteral">"   worsening moves: "</font> &lt;&lt; worsening_neighbors &lt;&lt; <font class="stringliteral">" ("</font>
00484               &lt;&lt; (100.0*worsening_neighbors)/neighbors &lt;&lt; <font class="stringliteral">"\%)"</font> &lt;&lt; std::endl
00485               &lt;&lt; <font class="stringliteral">"   non-improving moves: "</font> &lt;&lt; non_improving_neighbors &lt;&lt; <font class="stringliteral">" ("</font>
00486               &lt;&lt; (100.0*non_improving_neighbors)/neighbors &lt;&lt; <font class="stringliteral">"\%)"</font> &lt;&lt; std::endl;
00487   }
00488 
00497   template &lt;class Input, class State, class Move&gt;
<a name="l00498"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#a1">00498</a>   <font class="keywordtype">void</font> NeighborhoodExplorer&lt;Input,State,Move&gt;::FirstMove(<font class="keyword">const</font> State&amp; st, Move&amp; mv)<font class="keyword"> </font>
00499 <font class="keyword">  </font>{ 
00500     <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a3">RandomMove</a>(st,mv); 
00501     start_move = mv;
00502   }
00503 
00513   template &lt;class Input, class State, class Move&gt;  
<a name="l00514"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#a5">00514</a>   fvalue NeighborhoodExplorer&lt;Input,State,Move&gt;::SampleMove(<font class="keyword">const</font> State &amp;st, Move&amp; mv, <font class="keywordtype">int</font> samples)<font class="keyword"></font>
00515 <font class="keyword">  </font>{  
00516     <font class="keywordtype">int</font> s = 1;
00517     <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a3">RandomMove</a>(st,mv);
00518     fvalue mv_cost = <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a12">DeltaCostFunction</a>(st,mv);
00519     best_move = mv;
00520     fvalue best_delta = mv_cost;
00521     <font class="keywordflow">do</font> <font class="comment">// look for the best sampled move</font>
00522       { 
00523         mv_cost = <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a12">DeltaCostFunction</a>(st,mv);
00524         <font class="keywordflow">if</font> (mv_cost &lt; best_delta)
00525           { 
00526             best_move = mv;
00527             best_delta = mv_cost;
00528           }
00529         <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a3">RandomMove</a>(st,mv);
00530         s++;
00531       }
00532     <font class="keywordflow">while</font> (s &lt; samples);
00533     mv = best_move;
00534     <font class="keywordflow">return</font> best_delta;
00535   }
00536 
00546   template &lt;class Input, class State, class Move&gt;  
<a name="l00547"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#a6">00547</a>   fvalue NeighborhoodExplorer&lt;Input,State,Move&gt;::BestNonProhibitedMove(<font class="keyword">const</font> State &amp;st, Move&amp; mv, fvalue curr, fvalue best)<font class="keyword"> </font>
00548 <font class="keyword">  </font>{
00549     <font class="keyword">register</font> fvalue mv_cost;
00550     <font class="keywordtype">bool</font> tabu_move;
00551     <font class="keywordtype">bool</font> all_moves_tabu = <font class="keyword">true</font>;
00552         
00553     <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a1">FirstMove</a>(st,mv); 
00554     mv_cost = <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a12">DeltaCostFunction</a>(st,mv);
00555     best_move = mv;
00556     fvalue best_delta = mv_cost;
00557     <font class="keywordflow">do</font>  <font class="comment">// look for the best non prohibited move </font>
00558       { <font class="comment">// (if all moves are prohibited, then get the best)</font>
00559         tabu_move = p_pm-&gt;ProhibitedMove(mv,mv_cost,curr,best);      
00560         <font class="keywordflow">if</font> (   (mv_cost &lt; best_delta &amp;&amp; !tabu_move)
00561                || (mv_cost &lt; best_delta &amp;&amp; all_moves_tabu)
00562                || (all_moves_tabu &amp;&amp; !tabu_move))
00563           { 
00564             best_move = mv;
00565             best_delta = mv_cost;
00566           }
00567         <font class="keywordflow">if</font> (!tabu_move) 
00568           all_moves_tabu = <font class="keyword">false</font>;
00569         <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a2">NextMove</a>(st,mv);
00570         mv_cost = <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a12">DeltaCostFunction</a>(st,mv);
00571       }
00572     <font class="keywordflow">while</font> (!<a class="code" href="class_easylocal__NeighborhoodExplorer.html#a8">LastMoveDone</a>(mv));
00573     mv = best_move;
00574     <font class="keywordflow">return</font> best_delta;
00575   } 
00576 
00577   
00589   template &lt;class Input, class State, class Move&gt;  
<a name="l00590"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#a7">00590</a>   fvalue NeighborhoodExplorer&lt;Input,State,Move&gt;::SampleNonProhibitedMove(<font class="keyword">const</font> State &amp;st, Move&amp; mv, <font class="keywordtype">int</font> samples, fvalue curr, fvalue best)<font class="keyword"></font>
00591 <font class="keyword">  </font>{  
00592     <font class="keywordtype">int</font> s = 1;
00593     fvalue mv_cost;
00594     <font class="keywordtype">bool</font> tabu_move;
00595     <font class="keywordtype">bool</font> all_moves_tabu = <font class="keyword">true</font>;
00596         
00597     <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a3">RandomMove</a>(st,mv);
00598     mv_cost = <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a12">DeltaCostFunction</a>(st,mv);
00599     best_move = mv;
00600     fvalue best_delta = mv_cost;
00601     <font class="keywordflow">do</font> 
00602       { 
00603         tabu_move = p_pm-&gt;ProhibitedMove(mv,mv_cost,curr,best);      
00604         <font class="keywordflow">if</font> (   (mv_cost &lt; best_delta &amp;&amp; !tabu_move)
00605                || (mv_cost &lt; best_delta &amp;&amp; all_moves_tabu)
00606                || (all_moves_tabu &amp;&amp; !tabu_move))
00607           { 
00608             best_move = mv;
00609             best_delta = mv_cost;
00610           }
00611         <font class="keywordflow">if</font> (!tabu_move) 
00612           all_moves_tabu = <font class="keyword">false</font>;
00613         <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a3">RandomMove</a>(st,mv);
00614         mv_cost = <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a12">DeltaCostFunction</a>(st,mv);
00615         s++;
00616       }
00617     <font class="keywordflow">while</font> (s &lt; samples);
00618     mv = best_move;
00619     <font class="keywordflow">return</font> best_delta;
00620   }
00621 
00622 
00630   template &lt;class Input, class State, class Move&gt;  
<a name="l00631"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#a14">00631</a>   <font class="keywordtype">void</font> NeighborhoodExplorer&lt;Input,State,Move&gt;::PrintMoveInfo(<font class="keyword">const</font> State &amp;st, <font class="keyword">const</font> Move&amp; mv, std::ostream&amp; os)<font class="keyword"></font>
00632 <font class="keyword">  </font>{
00633     os &lt;&lt; <font class="stringliteral">"Move : "</font> &lt;&lt; mv &lt;&lt; std::endl;
00634     os &lt;&lt; <font class="stringliteral">"Start state cost : "</font> &lt;&lt; p_sm-&gt;CostFunction(st) &lt;&lt; std::endl;
00635     os &lt;&lt; <font class="stringliteral">"\tViolations : "</font> &lt;&lt; p_sm-&gt;Violations(st) &lt;&lt; std::endl;
00636     os &lt;&lt; <font class="stringliteral">"\tObjective  : "</font> &lt;&lt; p_sm-&gt;Objective(st) &lt;&lt; std::endl;
00637         
00638     os &lt;&lt; <font class="stringliteral">"Move cost : "</font> &lt;&lt; <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a12">DeltaCostFunction</a>(st,mv) &lt;&lt; std::endl;
00639     os &lt;&lt; <font class="stringliteral">"\tViolations : "</font> &lt;&lt; <a class="code" href="class_easylocal__NeighborhoodExplorer.html#b3">DeltaViolations</a>(st,mv) &lt;&lt; std::endl;
00640     os &lt;&lt; <font class="stringliteral">"\tObjective  : "</font> &lt;&lt; <a class="code" href="class_easylocal__NeighborhoodExplorer.html#b2">DeltaObjective</a>(st,mv) &lt;&lt; std::endl;
00641         
00642     State st1 = st;
00643     <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a11">MakeMove</a>(st1,mv);
00644     os &lt;&lt; <font class="stringliteral">"Final state cost : "</font> &lt;&lt; p_sm-&gt;CostFunction(st1) &lt;&lt; std::endl;  
00645     os &lt;&lt; <font class="stringliteral">"\tViolations : "</font> &lt;&lt; p_sm-&gt;Violations(st1) &lt;&lt; std::endl;
00646     os &lt;&lt; <font class="stringliteral">"\tObjective  : "</font> &lt;&lt; p_sm-&gt;Objective(st1) &lt;&lt; std::endl;
00647         
00648     os &lt;&lt; <font class="stringliteral">"Error : "</font> &lt;&lt; p_sm-&gt;CostFunction(st1) - <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a12">DeltaCostFunction</a>(st,mv) - p_sm-&gt;CostFunction(st) &lt;&lt; std::endl;
00649   }
00650 
00656   template &lt;class Input, class State, class Move&gt;
<a name="l00657"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#a16">00657</a>   <font class="keywordtype">void</font> NeighborhoodExplorer&lt;Input,State,Move&gt;::SetInput(Input* in)<font class="keyword"> </font>
00658 <font class="keyword">  </font>{ p_in = in; }
00659 
00665   template &lt;class Input, class State, class Move&gt;
<a name="l00666"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#a17">00666</a>   Input* NeighborhoodExplorer&lt;Input,State,Move&gt;::GetInput()<font class="keyword"> </font>
00667 <font class="keyword">  </font>{ <font class="keywordflow">return</font> p_in; }
00668 
00673   template &lt;class Input, class State, class Move&gt;  
<a name="l00674"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#a18">00674</a>   <font class="keywordtype">void</font> NeighborhoodExplorer&lt;Input,State,Move&gt;::Check()<font class="keyword"></font>
00675 <font class="keyword">  </font>{ assert(p_in != NULL &amp;&amp; p_in == p_sm-&gt;GetInput()); }
00676 
00688   template &lt;class Input, class State, class Move&gt;  
<a name="l00689"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#b3">00689</a>   fvalue NeighborhoodExplorer&lt;Input,State,Move&gt;::DeltaViolations(<font class="keyword">const</font> State&amp; st, <font class="keyword">const</font> Move &amp; mv)<font class="keyword"></font>
00690 <font class="keyword">  </font>{
00691     State st1 = st;
00692     <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a11">MakeMove</a>(st1,mv);
00693     <font class="keywordflow">return</font> p_sm-&gt;Violations(st1) - p_sm-&gt;Violations(st);
00694   }
00695 
00707   template &lt;class Input, class State, class Move&gt;  
<a name="l00708"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#b2">00708</a>   fvalue NeighborhoodExplorer&lt;Input,State,Move&gt;::DeltaObjective(<font class="keyword">const</font> State&amp; st, <font class="keyword">const</font> Move &amp; mv)<font class="keyword"></font>
00709 <font class="keyword">  </font>{
00710     State st1 = st;
00711     <a class="code" href="class_easylocal__NeighborhoodExplorer.html#a11">MakeMove</a>(st1,mv);
00712     <font class="keywordflow">return</font> p_sm-&gt;Objective(st1) - p_sm-&gt;Objective(st);
00713   }
00714 
00723   template &lt;class Input, class State, class Move&gt;  
<a name="l00724"></a><a class="code" href="class_easylocal__NeighborhoodExplorer.html#a8">00724</a>   <font class="keywordtype">bool</font> NeighborhoodExplorer&lt;Input,State,Move&gt;::LastMoveDone(<font class="keyword">const</font> Move &amp;mv)<font class="keyword"> </font>
00725 <font class="keyword">  </font>{ <font class="keywordflow">return</font> mv == start_move; } 
00726 
00727   <font class="comment">// Runner functions</font>
00728 
00735   template &lt;class Input, class State&gt;
<a name="l00736"></a><a class="code" href="class_easylocal__Runner.html#a1">00736</a>   Runner&lt;Input,State&gt;::Runner(std::string s, std::string t)
00737     : name(s), type(t) 
00738   {}
00739 
00745   template &lt;class Input, class State&gt;
<a name="l00746"></a><a class="code" href="class_easylocal__Runner.html#a14">00746</a>   std::string Runner&lt;Input,State&gt;::Name()<font class="keyword"> </font>
00747 <font class="keyword">  </font>{ <font class="keywordflow">return</font> name; }
00748 
00754   template &lt;class Input, class State&gt;
<a name="l00755"></a><a class="code" href="class_easylocal__Runner.html#a15">00755</a>   std::string Runner&lt;Input,State&gt;::Type()<font class="keyword"></font>
00756 <font class="keyword">  </font>{ <font class="keywordflow">return</font> type; }
00757 
00763   template &lt;class Input, class State&gt;
<a name="l00764"></a><a class="code" href="class_easylocal__Runner.html#a16">00764</a>   <font class="keywordtype">void</font> Runner&lt;Input,State&gt;::SetName(std::string s)<font class="keyword"> </font>
00765 <font class="keyword">  </font>{ name = s; } 
00766 
00778   template &lt;class Input, class State, class Move&gt;
<a name="l00779"></a><a class="code" href="class_easylocal__MoveRunner.html#b0">00779</a>   MoveRunner&lt;Input,State,Move&gt;::MoveRunner(StateManager&lt;Input,State&gt;* sm, NeighborhoodExplorer&lt;Input,State,Move&gt;* ne, Input* in, std::string name, std::string type)
00780     : Runner&lt;Input,State&gt;(name,type), p_in(in), p_sm(sm), p_nhe(ne)
00781   { 
00782     <font class="keywordflow">if</font> (in != NULL)
00783       current_state.SetInput(in);
00784     number_of_iterations = 0;
00785     max_iteration = ULONG_MAX;
00786     current_state_set = <font class="keyword">false</font>; 
00787   }
00788 
00794   template &lt;class Input, class State, class Move&gt;
<a name="l00795"></a><a class="code" href="class_easylocal__MoveRunner.html#a13">00795</a>   <font class="keywordtype">void</font> MoveRunner&lt;Input,State,Move&gt;::SetInput(Input* in)<font class="keyword"> </font>
00796 <font class="keyword">  </font>{ 
00797     p_in = in; 
00798     current_state.SetInput(in);
00799     current_state_set = <font class="keyword">false</font>;
00800     p_nhe-&gt;SetInput(in);
00801   }
00802 
00808   template &lt;class Input, class State, class Move&gt;
<a name="l00809"></a><a class="code" href="class_easylocal__MoveRunner.html#a14">00809</a>   Input* MoveRunner&lt;Input,State,Move&gt;::GetInput()<font class="keyword"> </font>
00810 <font class="keyword">  </font>{ <font class="keywordflow">return</font> p_in; }
00811 
00817   template &lt;class Input, class State, class Move&gt;
<a name="l00818"></a><a class="code" href="class_easylocal__MoveRunner.html#a15">00818</a>   <font class="keywordtype">void</font> MoveRunner&lt;Input,State,Move&gt;::Print(std::ostream&amp; os)<font class="keyword"> const</font>
00819 <font class="keyword">  </font>{ os &lt;&lt; name &lt;&lt; <font class="stringliteral">" : "</font> &lt;&lt; type &lt;&lt; std::endl; }
00820 
00825   template &lt;class Input, class State, class Move&gt;
<a name="l00826"></a><a class="code" href="class_easylocal__MoveRunner.html#a18">00826</a>   <font class="keywordtype">void</font> MoveRunner&lt;Input,State,Move&gt;::Check()<font class="keyword"> </font>
00827 <font class="keyword">  </font>{ 
00828     assert(p_in != NULL);
00829     assert(p_in == p_sm-&gt;GetInput());  
00830     assert(p_in == p_nhe-&gt;GetInput());
00831   }
00832 
00833 
00839   template &lt;class Input, class State, class Move&gt;
<a name="l00840"></a><a class="code" href="class_easylocal__MoveRunner.html#a3">00840</a>   <font class="keywordtype">void</font> MoveRunner&lt;Input,State,Move&gt;::SetCurrentState(<font class="keyword">const</font> State&amp; s)<font class="keyword"> </font>
00841 <font class="keyword">  </font>{ 
00842     current_state = s; 
00843     current_state_set = <font class="keyword">true</font>; 
00844     current_state_cost = p_sm-&gt;CostFunction(current_state); 
00845   }
00846 
00852   template &lt;class Input, class State, class Move&gt;
<a name="l00853"></a><a class="code" href="class_easylocal__MoveRunner.html#a4">00853</a>   State MoveRunner&lt;Input,State,Move&gt;::GetCurrentState()<font class="keyword"> </font>
00854 <font class="keyword">  </font>{ <font class="keywordflow">return</font> current_state; }
00855 
00861   template &lt;class Input, class State, class Move&gt;
<a name="l00862"></a><a class="code" href="class_easylocal__MoveRunner.html#a5">00862</a>   fvalue MoveRunner&lt;Input,State,Move&gt;::CurrentStateCost()<font class="keyword"> </font>
00863 <font class="keyword">  </font>{ <font class="keywordflow">return</font> current_state_cost; }
00864 
00870   template &lt;class Input, class State, class Move&gt;
<a name="l00871"></a><a class="code" href="class_easylocal__MoveRunner.html#a6">00871</a>   State MoveRunner&lt;Input,State,Move&gt;::GetBestState()<font class="keyword"> </font>
00872 <font class="keyword">  </font>{ <font class="keywordflow">return</font> best_state; }
00873 
00879   template &lt;class Input, class State, class Move&gt;
<a name="l00880"></a><a class="code" href="class_easylocal__MoveRunner.html#a7">00880</a>   fvalue MoveRunner&lt;Input,State,Move&gt;::BestStateCost()<font class="keyword"> </font>
00881 <font class="keyword">  </font>{ <font class="keywordflow">return</font> best_state_cost; }
00882 
00887   template &lt;class Input, class State, class Move&gt;
<a name="l00888"></a><a class="code" href="class_easylocal__MoveRunner.html#a8">00888</a>   <font class="keywordtype">void</font> MoveRunner&lt;Input,State,Move&gt;::ComputeCost()<font class="keyword">  </font>
00889 <font class="keyword">  </font>{ current_state_cost = p_sm-&gt;CostFunction(current_state); }
00890 
00896   template &lt;class Input, class State, class Move&gt;
<a name="l00897"></a><a class="code" href="class_easylocal__MoveRunner.html#a9">00897</a>   <font class="keywordtype">bool</font> MoveRunner&lt;Input,State,Move&gt;::LowerBoundReached()<font class="keyword"> </font>
00898 <font class="keyword">  </font>{ <font class="keywordflow">return</font> current_state_cost == 0; }
00899 
00905   template &lt;class Input, class State, class Move&gt;
<a name="l00906"></a><a class="code" href="class_easylocal__MoveRunner.html#a10">00906</a>   <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> MoveRunner&lt;Input,State,Move&gt;::NumberOfIterations()<font class="keyword"> const </font>
00907 <font class="keyword">  </font>{ <font class="keywordflow">return</font> number_of_iterations; }
00908 
00914   template &lt;class Input, class State, class Move&gt;
<a name="l00915"></a><a class="code" href="class_easylocal__MoveRunner.html#a11">00915</a>   <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> MoveRunner&lt;Input,State,Move&gt;::MaxIteration()<font class="keyword"> const </font>
00916 <font class="keyword">  </font>{ <font class="keywordflow">return</font> max_iteration; }
00917 
00922   template &lt;class Input, class State, class Move&gt;
<a name="l00923"></a><a class="code" href="class_easylocal__MoveRunner.html#a12">00923</a>   <font class="keywordtype">void</font> MoveRunner&lt;Input,State,Move&gt;::SetMaxIteration(<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> max)<font class="keyword">  </font>
00924 <font class="keyword">  </font>{ max_iteration = max; }
00925 
00931   template &lt;class Input, class State, class Move&gt;
<a name="l00932"></a><a class="code" href="class_easylocal__MoveRunner.html#a16">00932</a>   <font class="keywordtype">void</font> MoveRunner&lt;Input,State,Move&gt;::SetParameters(<font class="keyword">const</font> ParameterBox&amp; pb)<font class="keyword"></font>
00933 <font class="keyword">  </font>{   
00934     pb.Get(<font class="stringliteral">"max idle iteration"</font>,max_idle_iteration);
00935     pb.Get(<font class="stringliteral">"max iteration"</font>, max_iteration);
00936   }
00937 
00941   template &lt;class Input, class State, class Move&gt;
<a name="l00942"></a><a class="code" href="class_easylocal__MoveRunner.html#a1">00942</a>   <font class="keywordtype">void</font> MoveRunner&lt;Input,State,Move&gt;::Go()<font class="keyword"></font>
00943 <font class="keyword">  </font>{ 
00944     assert(current_state_set);
00945     <a class="code" href="class_easylocal__MoveRunner.html#b1">InitializeRun</a>();
00946     <font class="keywordflow">while</font> (!<a class="code" href="class_easylocal__MoveRunner.html#b5">MaxIterationExpired</a>() &amp;&amp; !<a class="code" href="class_easylocal__MoveRunner.html#b6">StopCriterion</a>() &amp;&amp; !<a class="code" href="class_easylocal__MoveRunner.html#a9">LowerBoundReached</a>())
00947       { 
00948         <a class="code" href="class_easylocal__MoveRunner.html#b4">UpdateIterationCounter</a>();
00949         <a class="code" href="class_easylocal__MoveRunner.html#b7">SelectMove</a>();
00950 <font class="preprocessor">#ifdef TRACE_MOVES</font>
00951 <font class="preprocessor"></font>        <a class="code" href="class_easylocal__MoveRunner.html#a15">Print</a>(); std::cerr &lt;&lt; <font class="stringliteral">"press any key ... "</font>; std::cin.get();
00952 <font class="preprocessor">#endif</font>
00953 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (<a class="code" href="class_easylocal__MoveRunner.html#b8">AcceptableMove</a>())
00954           { 
00955             <a class="code" href="class_easylocal__MoveRunner.html#b9">MakeMove</a>();
00956             <a class="code" href="class_easylocal__MoveRunner.html#b11">UpdateStateCost</a>();
00957             <a class="code" href="class_easylocal__MoveRunner.html#b10">StoreMove</a>();
00958           }
00959       }
00960     <a class="code" href="class_easylocal__MoveRunner.html#b2">TerminateRun</a>();
00961   }
00962 
00966   template &lt;class Input, class State, class Move&gt;
<a name="l00967"></a><a class="code" href="class_easylocal__MoveRunner.html#b9">00967</a>   <font class="keywordtype">void</font> MoveRunner&lt;Input,State,Move&gt;::MakeMove()<font class="keyword"> </font>
00968 <font class="keyword">  </font>{ 
00969 <font class="preprocessor">#ifdef TRACE_MOVES</font>
00970 <font class="preprocessor"></font>    p_nhe-&gt;PrintMoveInfo(current_state,current_move,std::cerr);
00971 <font class="preprocessor">#endif</font>
00972 <font class="preprocessor"></font><font class="preprocessor">#ifdef COST_DEBUG</font>
00973 <font class="preprocessor"></font>    fvalue ocost = current_state_cost;
00974     State previous_state = current_state;
00975 <font class="preprocessor">#endif</font>
00976 <font class="preprocessor"></font>    p_nhe-&gt;MakeMove(current_state,current_move); 
00977 <font class="preprocessor">#ifdef COST_DEBUG</font>
00978 <font class="preprocessor"></font>    fvalue ncost = p_sm-&gt;CostFunction(current_state);
00979     <font class="keywordflow">if</font> (<a class="code" href="namespace_easylocal.html#a4">distance</a>(ncost,(ocost+current_move_cost)) &gt; EPS)
00980       {
00981         std::cerr &lt;&lt; <font class="stringliteral">"Error in computing delta_cost: "</font> 
00982                   &lt;&lt; ncost-(ocost+current_move_cost) &lt;&lt; std::endl;
00983         std::cerr &lt;&lt; <font class="stringliteral">"Current iteration : "</font> &lt;&lt; number_of_iterations &lt;&lt; std::endl;
00984         std::cerr &lt;&lt; <font class="stringliteral">"Previous state : "</font> &lt;&lt; std::endl;
00985         std::cerr &lt;&lt; previous_state &lt;&lt; std::endl;
00986         std::cerr &lt;&lt; <font class="stringliteral">"Current state : "</font> &lt;&lt; std::endl;
00987         std::cerr &lt;&lt; current_state &lt;&lt; std::endl;
00988         p_nhe-&gt;PrintMoveInfo(previous_state,current_move,std::cerr);
00989         <font class="keywordtype">char</font> s[3];
00990         std::cout &lt;&lt; <font class="stringliteral">"Press enter to continue..."</font>;
00991         std::cin.getline(s,3);
00992       }
00993 <font class="preprocessor">#endif</font>
00994 <font class="preprocessor"></font><font class="preprocessor">#ifdef PLOT_DATA</font>
00995 <font class="preprocessor"></font>    assert(pos); <font class="comment">// the plot output stream must be set</font>
00996     *pos &lt;&lt; number_of_iterations &lt;&lt; <font class="stringliteral">"\t"</font> &lt;&lt; current_state_cost &lt;&lt; std::endl;
00997 <font class="preprocessor">#endif</font>
00998 <font class="preprocessor"></font>  }
00999 
01005   template &lt;class Input, class State, class Move&gt;
<a name="l01006"></a><a class="code" href="class_easylocal__MoveRunner.html#a2">01006</a>   <font class="keywordtype">void</font> MoveRunner&lt;Input,State,Move&gt;::Step(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> n)<font class="keyword"></font>
01007 <font class="keyword">  </font>{ 
01008     assert(current_state_set);
01009     <font class="keywordflow">for</font> (<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; n; i++) 
01010       { 
01011         <a class="code" href="class_easylocal__MoveRunner.html#b4">UpdateIterationCounter</a>();
01012         <a class="code" href="class_easylocal__MoveRunner.html#b7">SelectMove</a>();
01013         <font class="keywordflow">if</font> (<a class="code" href="class_easylocal__MoveRunner.html#b8">AcceptableMove</a>())
01014           { <a class="code" href="class_easylocal__MoveRunner.html#b9">MakeMove</a>();
01015           <a class="code" href="class_easylocal__MoveRunner.html#b11">UpdateStateCost</a>();
01016           <a class="code" href="class_easylocal__MoveRunner.html#b10">StoreMove</a>();
01017           <font class="keywordflow">if</font> (<a class="code" href="class_easylocal__MoveRunner.html#a9">LowerBoundReached</a>())
01018             <font class="keywordflow">break</font>;
01019           }
01020       }
01021   }
01022 
01027   template &lt;class Input, class State, class Move&gt;
<a name="l01028"></a><a class="code" href="class_easylocal__MoveRunner.html#b3">01028</a>   <font class="keywordtype">void</font> MoveRunner&lt;Input,State,Move&gt;::ComputeMoveCost()<font class="keyword"> </font>
01029 <font class="keyword">  </font>{ current_move_cost = p_nhe-&gt;DeltaCostFunction(current_state,current_move); }
01030 
01034   template &lt;class Input, class State, class Move&gt;
<a name="l01035"></a><a class="code" href="class_easylocal__MoveRunner.html#b4">01035</a>   <font class="keywordtype">void</font> MoveRunner&lt;Input,State,Move&gt;::UpdateIterationCounter()<font class="keyword"> </font>
01036 <font class="keyword">  </font>{ number_of_iterations++; }
01037 
01045   template &lt;class Input, class State, class Move&gt;
<a name="l01046"></a><a class="code" href="class_easylocal__MoveRunner.html#b5">01046</a>   <font class="keywordtype">bool</font> MoveRunner&lt;Input,State,Move&gt;::MaxIterationExpired()<font class="keyword"> </font>
01047 <font class="keyword">  </font>{ <font class="keywordflow">return</font> number_of_iterations &gt; max_iteration; }
01048 
01053   template &lt;class Input, class State, class Move&gt;
<a name="l01054"></a><a class="code" href="class_easylocal__MoveRunner.html#b8">01054</a>   <font class="keywordtype">bool</font> MoveRunner&lt;Input,State,Move&gt;::AcceptableMove()<font class="keyword"> </font>
01055 <font class="keyword">  </font>{ <font class="keywordflow">return</font> <font class="keyword">true</font>; }
01056 
01060   template &lt;class Input, class State, class Move&gt;
<a name="l01061"></a><a class="code" href="class_easylocal__MoveRunner.html#b11">01061</a>   <font class="keywordtype">void</font> MoveRunner&lt;Input,State,Move&gt;::UpdateStateCost()<font class="keyword"> </font>
01062 <font class="keyword">  </font>{ current_state_cost += current_move_cost; }
01063 
01067   template &lt;class Input, class State, class Move&gt;
<a name="l01068"></a><a class="code" href="class_easylocal__MoveRunner.html#b1">01068</a>   <font class="keywordtype">void</font> MoveRunner&lt;Input,State,Move&gt;::InitializeRun()<font class="keyword"></font>
01069 <font class="keyword">  </font>{
01070     number_of_iterations = 0;
01071     iteration_of_best = 0;
01072     <a class="code" href="class_easylocal__MoveRunner.html#a8">ComputeCost</a>();
01073     best_state = current_state;
01074     best_state_cost = current_state_cost;
01075   }
01076 
01077   <font class="comment">// Actual Runners</font>
01078 
01079 
01080   <font class="comment">// Hill Climbing</font>
01081   
01082 
01091   template &lt;class Input, class State, class Move&gt;
<a name="l01092"></a><a class="code" href="class_easylocal__HillClimbing.html#b0">01092</a>   HillClimbing&lt;Input,State,Move&gt;::HillClimbing(StateManager&lt;Input,State&gt;* s, NeighborhoodExplorer&lt;Input,State,Move&gt;* ne, Input* in)
01093     : MoveRunner&lt;Input,State,Move&gt;(s, ne, in, "Runner name", "Hill Climbing")
01094   { 
01095     <font class="comment">//  max_idle_iteration = 0; </font>
01096   }
01097 
01101   template &lt;class Input, class State, class Move&gt;   
<a name="l01102"></a><a class="code" href="class_easylocal__HillClimbing.html#a1">01102</a>   <font class="keywordtype">void</font> HillClimbing&lt;Input,State,Move&gt;::ReadParameters()<font class="keyword"> </font>
01103 <font class="keyword">  </font>{ 
01104     std::cout &lt;&lt; <font class="stringliteral">"HILL CLIMBING -- INPUT PARAMETERS"</font> &lt;&lt; std::endl;
01105     std::cout &lt;&lt; <font class="stringliteral">"Number of idle iterations: "</font>;
01106     std::cin &gt;&gt; max_idle_iteration;
01107   }
01108   
01113   template &lt;class Input, class State, class Move&gt;   
<a name="l01114"></a><a class="code" href="class_easylocal__HillClimbing.html#b6">01114</a>   <font class="keywordtype">void</font> HillClimbing&lt;Input,State,Move&gt;::SelectMove()<font class="keyword"> </font>
01115 <font class="keyword">  </font>{ 
01116     p_nhe-&gt;RandomMove(current_state,current_move); 
01117     <a class="code" href="class_easylocal__MoveRunner.html#b3">ComputeMoveCost</a>();
01118   }
01119 
01124   template &lt;class Input, class State, class Move&gt;
<a name="l01125"></a><a class="code" href="class_easylocal__HillClimbing.html#b1">01125</a>   <font class="keywordtype">void</font> HillClimbing&lt;Input,State,Move&gt;::InitializeRun()<font class="keyword"></font>
01126 <font class="keyword">  </font>{ 
01127     MoveRunner&lt;Input,State,Move&gt;::InitializeRun(); 
01128     assert(max_idle_iteration &gt; 0);
01129   }
01130 
01135   template &lt;class Input, class State, class Move&gt;
<a name="l01136"></a><a class="code" href="class_easylocal__HillClimbing.html#b2">01136</a>   <font class="keywordtype">void</font> HillClimbing&lt;Input,State,Move&gt;::TerminateRun()<font class="keyword"></font>
01137 <font class="keyword">  </font>{ 
01138     best_state = current_state;
01139     best_state_cost = current_state_cost;
01140   }
01141 
01146   template &lt;class Input, class State, class Move&gt;
<a name="l01147"></a><a class="code" href="class_easylocal__HillClimbing.html#b3">01147</a>   <font class="keywordtype">bool</font> HillClimbing&lt;Input,State,Move&gt;::StopCriterion()<font class="keyword"></font>
01148 <font class="keyword">  </font>{ <font class="keywordflow">return</font> number_of_iterations - iteration_of_best &gt;= max_idle_iteration; }
01149 
01154   template &lt;class Input, class State, class Move&gt;
<a name="l01155"></a><a class="code" href="class_easylocal__HillClimbing.html#b4">01155</a>   <font class="keywordtype">bool</font> HillClimbing&lt;Input,State,Move&gt;::AcceptableMove()<font class="keyword"></font>
01156 <font class="keyword">  </font>{ <font class="keywordflow">return</font> current_move_cost &lt;= 0; }
01157 
01162   template &lt;class Input, class State, class Move&gt;
<a name="l01163"></a><a class="code" href="class_easylocal__HillClimbing.html#b5">01163</a>   <font class="keywordtype">void</font> HillClimbing&lt;Input,State,Move&gt;::StoreMove()<font class="keyword"></font>
01164 <font class="keyword">  </font>{ 
01165     <font class="keywordflow">if</font> (fabs(current_move_cost) &lt; EPS)
01166       {
01167         iteration_of_best = number_of_iterations;
01168       }
01169   }
01170 
01176   template &lt;class Input, class State, class Move&gt;
<a name="l01177"></a><a class="code" href="class_easylocal__HillClimbing.html#a0">01177</a>   <font class="keywordtype">void</font> HillClimbing&lt;Input,State,Move&gt;::Print(std::ostream &amp; os)<font class="keyword"> const</font>
01178 <font class="keyword">  </font>{ 
01179     MoveRunner&lt;Input,State,Move&gt;::Print(os);
01180     os &lt;&lt; <font class="stringliteral">"PATAMETERS: "</font> &lt;&lt; std::endl;
01181     os &lt;&lt; <font class="stringliteral">"  Max idle iteration : "</font> &lt;&lt; max_idle_iteration &lt;&lt; std::endl;
01182     os &lt;&lt; <font class="stringliteral">"  Max iteration : "</font> &lt;&lt; max_iteration &lt;&lt; std::endl;
01183     os &lt;&lt; <font class="stringliteral">"RESULTS : "</font> &lt;&lt; std::endl;
01184     os &lt;&lt; <font class="stringliteral">"  Number of iterations : "</font> &lt;&lt; number_of_iterations &lt;&lt; std::endl;
01185     os &lt;&lt; <font class="stringliteral">"  Iteration of best : "</font> &lt;&lt; iteration_of_best &lt;&lt; std::endl;
01186     os &lt;&lt; <font class="stringliteral">"  Current state [cost: "</font> 
01187        &lt;&lt; current_state_cost &lt;&lt; <font class="stringliteral">"] "</font> &lt;&lt; std::endl;
01188     os &lt;&lt; current_state &lt;&lt; std::endl;
01189     os &lt;&lt; std::endl;
01190   }
01191 
01192   <font class="comment">// Steepest Descent</font>
01193 
01202   template &lt;class Input, class State, class Move&gt;
<a name="l01203"></a><a class="code" href="class_easylocal__SteepestDescent.html#b0">01203</a>   SteepestDescent&lt;Input,State,Move&gt;::SteepestDescent(StateManager&lt;Input,State&gt;* s, NeighborhoodExplorer&lt;Input,State,Move&gt;* ne, Input* in)
01204     : MoveRunner&lt;Input,State,Move&gt;(s, ne, in, "Runner name", "Steepest Descent")
01205   {}
01206 
01210   template &lt;class Input, class State, class Move&gt;   
<a name="l01211"></a><a class="code" href="class_easylocal__SteepestDescent.html#b5">01211</a>   <font class="keywordtype">void</font> SteepestDescent&lt;Input,State,Move&gt;::SelectMove()<font class="keyword"> </font>
01212 <font class="keyword">  </font>{ current_move_cost = p_nhe-&gt;BestMove(current_state,current_move); }
01213 
01218   template &lt;class Input, class State, class Move&gt;
<a name="l01219"></a><a class="code" href="class_easylocal__SteepestDescent.html#b1">01219</a>   <font class="keywordtype">void</font> SteepestDescent&lt;Input,State,Move&gt;::InitializeRun()<font class="keyword"></font>
01220 <font class="keyword">  </font>{ 
01221     MoveRunner&lt;Input,State,Move&gt;::InitializeRun(); 
01222     current_move_cost = -1; <font class="comment">// needed for passing the first time </font>
01223                             <font class="comment">// the StopCriterion test</font>
01224   }
01225 
01229   template &lt;class Input, class State, class Move&gt;
<a name="l01230"></a><a class="code" href="class_easylocal__SteepestDescent.html#b3">01230</a>   <font class="keywordtype">bool</font> SteepestDescent&lt;Input,State,Move&gt;::StopCriterion()<font class="keyword"></font>
01231 <font class="keyword">  </font>{ <font class="keywordflow">return</font> current_move_cost &gt;= 0; }
01232 
01236   template &lt;class Input, class State, class Move&gt;
<a name="l01237"></a><a class="code" href="class_easylocal__SteepestDescent.html#b4">01237</a>   <font class="keywordtype">bool</font> SteepestDescent&lt;Input,State,Move&gt;::AcceptableMove()<font class="keyword"></font>
01238 <font class="keyword">  </font>{ <font class="keywordflow">return</font> current_move_cost &lt; 0; }
01239 
01244   template &lt;class Input, class State, class Move&gt;
<a name="l01245"></a><a class="code" href="class_easylocal__SteepestDescent.html#b2">01245</a>   <font class="keywordtype">void</font> SteepestDescent&lt;Input,State,Move&gt;::TerminateRun()<font class="keyword"></font>
01246 <font class="keyword">  </font>{ 
01247     best_state = current_state;
01248     best_state_cost = current_state_cost;
01249   }
01250   
01256   template &lt;class Input, class State, class Move&gt;
<a name="l01257"></a><a class="code" href="class_easylocal__SteepestDescent.html#a0">01257</a>   <font class="keywordtype">void</font> SteepestDescent&lt;Input,State,Move&gt;::Print(std::ostream &amp; os)<font class="keyword"> const</font>
01258 <font class="keyword">  </font>{  
01259     MoveRunner&lt;Input,State,Move&gt;::Print(os);
01260     os &lt;&lt; <font class="stringliteral">"PATAMETERS: "</font> &lt;&lt; std::endl;
01261     os &lt;&lt; <font class="stringliteral">"  Max iteration : "</font> &lt;&lt; max_iteration &lt;&lt; std::endl;
01262     os &lt;&lt; <font class="stringliteral">"RESULTS : "</font> &lt;&lt; std::endl;
01263     os &lt;&lt; <font class="stringliteral">"  Number of iterations : "</font> &lt;&lt; number_of_iterations &lt;&lt; std::endl;
01264     os &lt;&lt; <font class="stringliteral">"  Current state [cost: "</font> 
01265        &lt;&lt; current_state_cost &lt;&lt; <font class="stringliteral">"] "</font> &lt;&lt; std::endl;
01266     os &lt;&lt; current_state &lt;&lt; std::endl;
01267     os &lt;&lt; std::endl;
01268   }
01269 
01270   <font class="comment">// Tabu Search</font>
01271   
01281   template &lt;class Input, class State, class Move&gt;
<a name="l01282"></a><a class="code" href="class_easylocal__TabuSearch.html#b0">01282</a>   TabuSearch&lt;Input,State,Move&gt;::TabuSearch(StateManager&lt;Input,State&gt;* s, NeighborhoodExplorer&lt;Input,State,Move&gt;* ne, TabuListManager&lt;Move&gt;* tlm, Input* in)
01283     : MoveRunner&lt;Input,State,Move&gt;(s, ne, in, "Runner name", "Tabu Search")
01284   { 
01285     <font class="keywordflow">if</font> (in != NULL)
01286       best_state.SetInput(in);
01287         
01288     <a class="code" href="class_easylocal__TabuSearch.html#b1">SetTabuListManager</a>(tlm); 
01289     p_pm = tlm;
01290     p_nhe-&gt;SetProhibitionManager(p_pm);
01291   }
01292 
01298   template &lt;class Input, class State, class Move&gt;
<a name="l01299"></a><a class="code" href="class_easylocal__TabuSearch.html#a2">01299</a>   <font class="keywordtype">void</font> TabuSearch&lt;Input,State,Move&gt;::SetInput(Input* in)<font class="keyword"> </font>
01300 <font class="keyword">  </font>{ 
01301     MoveRunner&lt;Input,State,Move&gt;::SetInput(in);
01302     best_state.SetInput(in); 
01303   }
01304 
01308   template &lt;class Input, class State, class Move&gt;
<a name="l01309"></a><a class="code" href="class_easylocal__TabuSearch.html#a0">01309</a>   <font class="keywordtype">void</font> TabuSearch&lt;Input,State,Move&gt;::ReadParameters()<font class="keyword"></font>
01310 <font class="keyword">  </font>{
01311     <font class="keywordtype">int</font> min_tabu, max_tabu;
01312     std::cout &lt;&lt; <font class="stringliteral">"TABU SEARCH -- INPUT PARAMETERS"</font> &lt;&lt; std::endl;
01313     std::cout &lt;&lt; <font class="stringliteral">"Length of the tabu list (min,max): "</font>;
01314     std::cin &gt;&gt; min_tabu &gt;&gt; max_tabu;
01315     p_pm-&gt;SetLength(min_tabu,max_tabu);
01316     std::cout &lt;&lt; <font class="stringliteral">"Number of idle iterations: "</font>;
01317     std::cin &gt;&gt; max_idle_iteration;
01318   }
01319 
01327   template &lt;class Input, class State, class Move&gt;
<a name="l01328"></a><a class="code" href="class_easylocal__TabuSearch.html#b1">01328</a>   <font class="keywordtype">void</font> TabuSearch&lt;Input,State,Move&gt;::SetTabuListManager(TabuListManager&lt;Move&gt;* tlm, <font class="keywordtype">int</font> min_tabu, <font class="keywordtype">int</font> max_tabu)<font class="keyword"></font>
01329 <font class="keyword">  </font>{ 
01330     p_pm = tlm;
01331     <font class="keywordflow">if</font> (max_tabu != 0) <font class="comment">// if min_tabu and max_tabu are properly set</font>
01332       p_pm-&gt;SetLength(min_tabu,max_tabu);
01333     p_nhe-&gt;SetProhibitionManager(p_pm);
01334   }
01335 
01336 
01341   template &lt;class Input, class State, class Move&gt;
<a name="l01342"></a><a class="code" href="class_easylocal__TabuSearch.html#b2">01342</a>   <font class="keywordtype">void</font> TabuSearch&lt;Input,State,Move&gt;::InitializeRun()<font class="keyword"></font>
01343 <font class="keyword">  </font>{
01344     MoveRunner&lt;Input,State,Move&gt;::InitializeRun(); 
01345     assert(max_idle_iteration &gt; 0);
01346     p_pm-&gt;Clean();
01347   }
01348 
01353   template &lt;class Input, class State, class Move&gt;
<a name="l01354"></a><a class="code" href="class_easylocal__TabuSearch.html#b4">01354</a>   <font class="keywordtype">void</font> TabuSearch&lt;Input,State,Move&gt;::SelectMove()<font class="keyword"> </font>
01355 <font class="keyword">  </font>{ current_move_cost = p_nhe-&gt;BestNonProhibitedMove(current_state, current_move, current_state_cost, best_state_cost); }
01356 
01361   template &lt;class Input, class State, class Move&gt;  
<a name="l01362"></a><a class="code" href="class_easylocal__TabuSearch.html#b3">01362</a>   <font class="keywordtype">bool</font> TabuSearch&lt;Input,State,Move&gt;::StopCriterion()<font class="keyword"></font>
01363 <font class="keyword">  </font>{ <font class="keywordflow">return</font> number_of_iterations - iteration_of_best &gt;= max_idle_iteration; }
01364 
01370   template &lt;class Input, class State, class Move&gt;  
<a name="l01371"></a><a class="code" href="class_easylocal__TabuSearch.html#b5">01371</a>   <font class="keywordtype">bool</font> TabuSearch&lt;Input,State,Move&gt;::AcceptableMove()<font class="keyword"> </font>{ <font class="keywordflow">return</font> <font class="keyword">true</font>; }
01372 
01373   
01379   template &lt;class Input, class State, class Move&gt;  
<a name="l01380"></a><a class="code" href="class_easylocal__TabuSearch.html#a3">01380</a>   <font class="keywordtype">void</font> TabuSearch&lt;Input,State,Move&gt;::SetParameters(<font class="keyword">const</font> ParameterBox&amp; pb)<font class="keyword"></font>
01381 <font class="keyword">  </font>{
01382     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> min_tabu, max_tabu;
01383     MoveRunner&lt;Input,State,Move&gt;::SetParameters(pb);
01384     pb.Get(<font class="stringliteral">"min tenure"</font>, min_tabu);
01385     pb.Get(<font class="stringliteral">"max tenure"</font>, max_tabu);
01386     p_pm-&gt;SetLength(min_tabu,max_tabu);
01387   }
01388 
01393   template &lt;class Input, class State, class Move&gt;  
<a name="l01394"></a><a class="code" href="class_easylocal__TabuSearch.html#b6">01394</a>   <font class="keywordtype">void</font> TabuSearch&lt;Input,State,Move&gt;::StoreMove()<font class="keyword"></font>
01395 <font class="keyword">  </font>{
01396     p_pm-&gt;InsertMove(current_move, current_move_cost, current_state_cost, best_state_cost);
01397     <font class="keywordflow">if</font> (current_state_cost + EPS &lt; best_state_cost)
01398       { 
01399         iteration_of_best = number_of_iterations;
01400         best_state = current_state;
01401         best_state_cost = current_state_cost;
01402       }
01403   }
01404 
01410   template &lt;class Input, class State, class Move&gt;
<a name="l01411"></a><a class="code" href="class_easylocal__TabuSearch.html#a1">01411</a>   <font class="keywordtype">void</font> TabuSearch&lt;Input,State,Move&gt;::Print(std::ostream &amp; os)<font class="keyword"> const</font>
01412 <font class="keyword">  </font>{  
01413     MoveRunner&lt;Input,State,Move&gt;::Print(os);
01414     os &lt;&lt; <font class="stringliteral">"PATAMETERS: "</font> &lt;&lt; std::endl;
01415     os &lt;&lt; <font class="stringliteral">"  Max idle iteration : "</font> &lt;&lt; max_idle_iteration &lt;&lt; std::endl;
01416     os &lt;&lt; <font class="stringliteral">"  Max iteration : "</font> &lt;&lt; max_iteration &lt;&lt; std::endl;
01417     os &lt;&lt; <font class="stringliteral">"  Tenure : "</font> &lt;&lt; p_pm-&gt;MinTenure() &lt;&lt; <font class="charliteral">'-'</font> &lt;&lt; p_pm-&gt;MaxTenure() &lt;&lt; std::endl;
01418     os &lt;&lt; <font class="stringliteral">"RESULTS : "</font> &lt;&lt; std::endl;
01419     os &lt;&lt; <font class="stringliteral">"  Number of iterations : "</font> &lt;&lt; number_of_iterations &lt;&lt; std::endl;
01420     os &lt;&lt; <font class="stringliteral">"  Iteration of best : "</font> &lt;&lt; iteration_of_best &lt;&lt; std::endl;
01421     os &lt;&lt; <font class="stringliteral">"  Current state [cost: "</font> 
01422        &lt;&lt; current_state_cost &lt;&lt; <font class="stringliteral">"] "</font> &lt;&lt; std::endl
01423        &lt;&lt; current_state &lt;&lt; std::endl;
01424     os &lt;&lt; <font class="stringliteral">"  Best State    [cost: "</font> 
01425        &lt;&lt; best_state_cost &lt;&lt; <font class="stringliteral">"] "</font> &lt;&lt; std::endl
01426        &lt;&lt; best_state &lt;&lt; std::endl &lt;&lt; std::endl;
01427     os &lt;&lt; <font class="stringliteral">"Tabu list : "</font> &lt;&lt; std::endl;
01428     os &lt;&lt; *p_pm; 
01429     os &lt;&lt; std::endl &lt;&lt; std::endl;
01430   }
01431 
01432   <font class="comment">// Simulated Annealing</font>
01433 
01442   template &lt;class Input, class State, class Move&gt;
<a name="l01443"></a><a class="code" href="class_easylocal__SimulatedAnnealing.html#b0">01443</a>   SimulatedAnnealing&lt;Input,State,Move&gt;::SimulatedAnnealing(StateManager&lt;Input,State&gt;* s, NeighborhoodExplorer&lt;Input,State,Move&gt;* ne, Input* in)
01444     : MoveRunner&lt;Input,State,Move&gt;(s, ne, in, "Runner name", "Simulated Annealing")
01445   { 
01446     min_temperature = 0.0001;
01447   }
01448 
01452   template &lt;class Input, class State, class Move&gt;
<a name="l01453"></a><a class="code" href="class_easylocal__SimulatedAnnealing.html#a0">01453</a>   <font class="keywordtype">void</font> SimulatedAnnealing&lt;Input,State,Move&gt;::ReadParameters()<font class="keyword"></font>
01454 <font class="keyword">  </font>{
01455     std::cout &lt;&lt; <font class="stringliteral">"SIMULATED ANNEALING -- INPUT PARAMETERS"</font> &lt;&lt; std::endl;
01456     std::cout &lt;&lt; <font class="stringliteral">"Start temperature: "</font>;
01457     std::cin &gt;&gt; start_temperature;
01458     std::cout &lt;&lt; <font class="stringliteral">"Cooling rate: "</font>;
01459     std::cin &gt;&gt; cooling_rate;
01460     std::cout &lt;&lt; <font class="stringliteral">"Neighbors sampled at each temperature : "</font>;
01461     std::cin &gt;&gt; neighbor_sample;
01462   }
01463 
01468   template &lt;class Input, class State, class Move&gt;
<a name="l01469"></a><a class="code" href="class_easylocal__SimulatedAnnealing.html#b1">01469</a>   <font class="keywordtype">void</font> SimulatedAnnealing&lt;Input,State,Move&gt;::InitializeRun()<font class="keyword"></font>
01470 <font class="keyword">  </font>{
01471     MoveRunner&lt;Input,State,Move&gt;::InitializeRun(); 
01472     assert(start_temperature &gt; 0 &amp;&amp; cooling_rate &gt; 0 &amp;&amp; neighbor_sample &gt; 0);
01473     temperature = start_temperature;
01474   }
01475 
01479   template &lt;class Input, class State, class Move&gt;
<a name="l01480"></a><a class="code" href="class_easylocal__SimulatedAnnealing.html#b2">01480</a>   <font class="keywordtype">void</font> SimulatedAnnealing&lt;Input,State,Move&gt;::TerminateRun()<font class="keyword"></font>
01481 <font class="keyword">  </font>{ 
01482     best_state = current_state;
01483     best_state_cost = current_state_cost;
01484   }
01485 
01489   template &lt;class Input, class State, class Move&gt;
<a name="l01490"></a><a class="code" href="class_easylocal__SimulatedAnnealing.html#b5">01490</a>   <font class="keywordtype">void</font> SimulatedAnnealing&lt;Input,State,Move&gt;::SelectMove()<font class="keyword"> </font>
01491 <font class="keyword">  </font>{ 
01492     p_nhe-&gt;RandomMove(current_state, current_move); 
01493     <a class="code" href="class_easylocal__MoveRunner.html#b3">ComputeMoveCost</a>(); 
01494   }
01495 
01501   template &lt;class Input, class State, class Move&gt;
<a name="l01502"></a><a class="code" href="class_easylocal__SimulatedAnnealing.html#a1">01502</a>   <font class="keywordtype">void</font> SimulatedAnnealing&lt;Input,State,Move&gt;::SetParameters(<font class="keyword">const</font> ParameterBox&amp; pb)<font class="keyword"></font>
01503 <font class="keyword">  </font>{
01504     pb.Get(<font class="stringliteral">"start temperature"</font>, start_temperature);
01505     pb.Get(<font class="stringliteral">"cooling rate"</font>, cooling_rate);
01506     pb.Get(<font class="stringliteral">"neighbors sampled"</font>, neighbor_sample);
01507     pb.Get(<font class="stringliteral">"max iteration"</font>, max_iteration);
01508   }
01509 
01515   template &lt;class Input, class State, class Move&gt;
<a name="l01516"></a><a class="code" href="class_easylocal__SimulatedAnnealing.html#a2">01516</a>   <font class="keywordtype">void</font> SimulatedAnnealing&lt;Input,State,Move&gt;::Print(std::ostream &amp; os)<font class="keyword"> const</font>
01517 <font class="keyword">  </font>{
01518     MoveRunner&lt;Input,State,Move&gt;::Print(os);
01519     os &lt;&lt; <font class="stringliteral">"PATAMETERS: "</font> &lt;&lt; std::endl;
01520     os &lt;&lt; <font class="stringliteral">"  Start temperature : "</font> &lt;&lt; start_temperature &lt;&lt; std::endl;
01521     os &lt;&lt; <font class="stringliteral">"  Cooling rate : "</font> &lt;&lt; cooling_rate &lt;&lt; std::endl;
01522     os &lt;&lt; <font class="stringliteral">"  Neighbor sample : "</font> &lt;&lt; neighbor_sample &lt;&lt; std::endl;
01523     os &lt;&lt; <font class="stringliteral">"  Max iteration : "</font> &lt;&lt; max_iteration &lt;&lt; std::endl;
01524     os &lt;&lt; <font class="stringliteral">"RESULTS : "</font> &lt;&lt; std::endl;
01525     os &lt;&lt; <font class="stringliteral">"  Number of iterations : "</font> &lt;&lt; number_of_iterations &lt;&lt; std::endl;
01526     os &lt;&lt; <font class="stringliteral">"  Current state [cost: "</font> 
01527        &lt;&lt; current_state_cost &lt;&lt; <font class="stringliteral">"] "</font> &lt;&lt; std::endl
01528        &lt;&lt; current_state &lt;&lt; std::endl;
01529   }
01530 
01534   template &lt;class Input, class State, class Move&gt;
<a name="l01535"></a><a class="code" href="class_easylocal__SimulatedAnnealing.html#b3">01535</a>   <font class="keywordtype">bool</font> SimulatedAnnealing&lt;Input,State,Move&gt;::StopCriterion()<font class="keyword"></font>
01536 <font class="keyword">  </font>{ <font class="keywordflow">return</font> temperature &lt;= min_temperature; }
01537 
01542   template &lt;class Input, class State, class Move&gt;
<a name="l01543"></a><a class="code" href="class_easylocal__SimulatedAnnealing.html#b4">01543</a>   <font class="keywordtype">void</font> SimulatedAnnealing&lt;Input,State,Move&gt;::UpdateIterationCounter()<font class="keyword"> </font>
01544 <font class="keyword">  </font>{ number_of_iterations++; 
01545   <font class="keywordflow">if</font> (number_of_iterations % neighbor_sample == 0)
01546     temperature *= cooling_rate;
01547   }
01548 
01553   template &lt;class Input, class State, class Move&gt;
<a name="l01554"></a><a class="code" href="class_easylocal__SimulatedAnnealing.html#b6">01554</a>   <font class="keywordtype">bool</font> SimulatedAnnealing&lt;Input,State,Move&gt;::AcceptableMove()<font class="keyword"></font>
01555 <font class="keyword">  </font>{ <font class="keywordflow">return</font> (current_move_cost &lt;= 0)
01556       || (rand() &lt; exp(-current_move_cost/temperature)); }
01557 
01563   template &lt;class Input, class Output&gt;
<a name="l01564"></a><a class="code" href="class_easylocal__Solver.html#a1">01564</a>   <font class="keywordtype">void</font> Solver&lt;Input,Output&gt;::SetInput(Input* in)<font class="keyword"> </font>
01565 <font class="keyword">  </font>{ p_in = in; }
01566 
01572   template &lt;class Input, class Output&gt;
<a name="l01573"></a><a class="code" href="class_easylocal__Solver.html#a4">01573</a>   <font class="keywordtype">void</font> Solver&lt;Input,Output&gt;::SetOutput(Output* out)<font class="keyword"> </font>
01574 <font class="keyword">  </font>{ p_out = out; }
01575 
01582   template &lt;class Input, class Output&gt;
<a name="l01583"></a><a class="code" href="class_easylocal__Solver.html#b0">01583</a>   Solver&lt;Input,Output&gt;::Solver(Input* in, Output* out)
01584     : p_in(in), p_out(out) 
01585   {}
01586 
01592   template &lt;class Input, class Output&gt;
<a name="l01593"></a><a class="code" href="class_easylocal__Solver.html#a2">01593</a>   Input* Solver&lt;Input,Output&gt;::GetInput()<font class="keyword"></font>
01594 <font class="keyword">  </font>{ <font class="keywordflow">return</font> p_in; }
01595 
01601   template &lt;class Input, class Output&gt;
<a name="l01602"></a><a class="code" href="class_easylocal__Solver.html#a3">01602</a>   Output* Solver&lt;Input,Output&gt;::GetOutput()<font class="keyword"></font>
01603 <font class="keyword">  </font>{ <font class="keywordflow">return</font> p_out; }
01604 
01609   template &lt;class Input, class Output, class State&gt;
<a name="l01610"></a><a class="code" href="class_easylocal__LocalSearchSolver.html#a0">01610</a>   <font class="keywordtype">void</font> LocalSearchSolver&lt;Input,Output,State&gt;::SetInitTrials(<font class="keywordtype">int</font> t)<font class="keyword"> </font>
01611 <font class="keyword">  </font>{ number_of_init_trials = t; }
01612 
01618   template &lt;class Input, class Output, class State&gt;
<a name="l01619"></a><a class="code" href="class_easylocal__LocalSearchSolver.html#a4">01619</a>   <font class="keywordtype">void</font> LocalSearchSolver&lt;Input,Output,State&gt;::SetInput(Input* in)<font class="keyword"> </font>
01620 <font class="keyword">  </font>{ 
01621     p_in = in;
01622     internal_state.SetInput(in); 
01623   }
01624 
01630   template &lt;class Input, class Output, class State&gt;
<a name="l01631"></a><a class="code" href="class_easylocal__LocalSearchSolver.html#a6">01631</a>   fvalue LocalSearchSolver&lt;Input,Output,State&gt;::InternalStateCost()<font class="keyword"> </font>
01632 <font class="keyword">  </font>{ <font class="keywordflow">return</font> internal_state_cost; }
01633 
01643   template &lt;class Input, class Output, class State&gt;
<a name="l01644"></a><a class="code" href="class_easylocal__LocalSearchSolver.html#b0">01644</a>   LocalSearchSolver&lt;Input,Output,State&gt;::LocalSearchSolver(StateManager&lt;Input,State&gt;* sm, OutputManager&lt;Input,Output,State&gt;* om, Input* in, Output* out) 
01645     : Solver&lt;Input, Output&gt;(in,out), p_sm(sm),  p_om(om), 
01646     number_of_init_trials(1)
01647   {
01648     <font class="keywordflow">if</font> (in != NULL)
01649       internal_state.SetInput(in); 
01650   }
01651 
01656   template &lt;class Input, class Output, class State&gt;
<a name="l01657"></a><a class="code" href="class_easylocal__LocalSearchSolver.html#b3">01657</a>   <font class="keywordtype">void</font> LocalSearchSolver&lt;Input,Output,State&gt;::DeliverOutput()<font class="keyword"> </font>
01658 <font class="keyword">  </font>{ p_om-&gt;OutputState(internal_state,*p_out); }
01659 
01664   template &lt;class Input, class Output, class State&gt;
<a name="l01665"></a><a class="code" href="class_easylocal__LocalSearchSolver.html#b4">01665</a>   <font class="keywordtype">void</font> LocalSearchSolver&lt;Input,Output,State&gt;::FindInitialState()<font class="keyword"> </font>
01666 <font class="keyword">  </font>{ internal_state_cost = p_sm-&gt;SampleState(internal_state,number_of_init_trials); }
01667 
01671   template &lt;class Input, class Output, class State&gt;
<a name="l01672"></a><a class="code" href="class_easylocal__LocalSearchSolver.html#b5">01672</a>   <font class="keywordtype">void</font> LocalSearchSolver&lt;Input,Output,State&gt;::ComputeCost()<font class="keyword"> </font>
01673 <font class="keyword">  </font>{ internal_state_cost = p_sm-&gt;CostFunction(internal_state); }
01674 
01675 
01680   template &lt;class Input, class Output, class State&gt;
<a name="l01681"></a><a class="code" href="class_easylocal__LocalSearchSolver.html#a5">01681</a>   <font class="keywordtype">void</font> LocalSearchSolver&lt;Input,Output,State&gt;::Check()<font class="keyword"></font>
01682 <font class="keyword">  </font>{
01683     assert(p_in != NULL);
01684     assert(p_in == p_sm-&gt;GetInput());
01685     assert(p_in == p_om-&gt;GetInput());
01686   }
01687 
01694   template &lt;class Input, class Output, class State&gt;
<a name="l01695"></a><a class="code" href="class_easylocal__SimpleLocalSearch.html#a0">01695</a>   <font class="keywordtype">void</font> SimpleLocalSearch&lt;Input,Output,State&gt;::SetRunner(Runner&lt;Input,State&gt; *r)<font class="keyword"> </font>
01696 <font class="keyword">  </font>{ p_runner = r; }
01697 
01698 
01710   template &lt;class Input, class Output, class State&gt;
<a name="l01711"></a><a class="code" href="class_easylocal__SimpleLocalSearch.html#b0">01711</a>   SimpleLocalSearch&lt;Input,Output,State&gt;::SimpleLocalSearch(StateManager&lt;Input,State&gt;* sm, OutputManager&lt;Input,Output,State&gt;* om, Runner&lt;Input,State&gt;* r, Input* in, Output* out)
01712     : LocalSearchSolver&lt;Input,Output,State&gt;(sm,om,in,out) 
01713   { p_runner = r; }
01714 
01715 
01725   template &lt;class Input, class Output, class State&gt;
<a name="l01726"></a><a class="code" href="class_easylocal__SimpleLocalSearch.html#b1">01726</a>   SimpleLocalSearch&lt;Input,Output,State&gt;::SimpleLocalSearch(StateManager&lt;Input,State&gt;* sm, OutputManager&lt;Input,Output,State&gt;* om, Input* in, Output* out)
01727     : LocalSearchSolver&lt;Input,Output,State&gt;(sm,om,in,out) 
01728   { p_runner = NULL; }
01729 
01730 
01736   template &lt;class Input, class Output, class State&gt;
<a name="l01737"></a><a class="code" href="class_easylocal__SimpleLocalSearch.html#b3">01737</a>   <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> SimpleLocalSearch&lt;Input,Output,State&gt;::NumberOfIterations()<font class="keyword"> const </font>
01738 <font class="keyword">  </font>{ <font class="keywordflow">return</font> p_runner-&gt;NumberOfIterations(); }
01739 
01743   template &lt;class Input, class Output, class State&gt;
<a name="l01744"></a><a class="code" href="class_easylocal__SimpleLocalSearch.html#b2">01744</a>   <font class="keywordtype">void</font> SimpleLocalSearch&lt;Input,Output,State&gt;::Run()<font class="keyword"></font>
01745 <font class="keyword">  </font>{
01746     p_runner-&gt;SetCurrentState(internal_state);
01747     p_runner-&gt;Go();
01748     internal_state = p_runner-&gt;GetBestState();
01749     internal_state_cost = p_runner-&gt;BestStateCost();
01750   }
01751 
01756   template &lt;class Input, class Output, class State&gt;
<a name="l01757"></a><a class="code" href="class_easylocal__LocalSearchSolver.html#a1">01757</a>   <font class="keywordtype">void</font> LocalSearchSolver&lt;Input,Output,State&gt;::Solve()<font class="keyword"></font>
01758 <font class="keyword">  </font>{
01759     <a class="code" href="class_easylocal__LocalSearchSolver.html#b4">FindInitialState</a>();
01760     <a class="code" href="class_easylocal__LocalSearchSolver.html#b1">Run</a>();
01761     <a class="code" href="class_easylocal__LocalSearchSolver.html#b3">DeliverOutput</a>();
01762   }
01763   
01768   template &lt;class Input, class Output, class State&gt;
<a name="l01769"></a><a class="code" href="class_easylocal__LocalSearchSolver.html#a2">01769</a>   <font class="keywordtype">void</font> LocalSearchSolver&lt;Input,Output,State&gt;::ReSolve()<font class="keyword"></font>
01770 <font class="keyword">  </font>{
01771     <a class="code" href="class_easylocal__LocalSearchSolver.html#b1">Run</a>();
01772     <a class="code" href="class_easylocal__LocalSearchSolver.html#b3">DeliverOutput</a>();
01773   }
01774 
01781   template &lt;class Input, class Output, class State&gt;
<a name="l01782"></a><a class="code" href="class_easylocal__LocalSearchSolver.html#a3">01782</a>   <font class="keywordtype">void</font> LocalSearchSolver&lt;Input,Output,State&gt;::MultiStartSolve(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> n)<font class="keyword"></font>
01783 <font class="keyword">  </font>{ 
01784     State best_state;
01785     fvalue best_state_cost = 0; <font class="comment">// we assign it a value only to prevent</font>
01786                                 <font class="comment">// warnings from "smart" compilers</font>
01787     <font class="keywordflow">for</font> (<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; n; i++)
01788       { 
01789         <a class="code" href="class_easylocal__LocalSearchSolver.html#b4">FindInitialState</a>();
01790         <a class="code" href="class_easylocal__LocalSearchSolver.html#b1">Run</a>();
01791         <font class="keywordflow">if</font> (i == 0 || internal_state_cost &lt; best_state_cost)
01792           { 
01793             best_state = internal_state;
01794             best_state_cost = internal_state_cost;
01795           }
01796       }
01797     internal_state = best_state;
01798     internal_state_cost = best_state_cost;
01799     <a class="code" href="class_easylocal__LocalSearchSolver.html#b3">DeliverOutput</a>();
01800   }
01801 
01806   template &lt;class Input, class Output, class State&gt;
<a name="l01807"></a><a class="code" href="class_easylocal__MultiRunnerSolver.html#b1">01807</a>   <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> MultiRunnerSolver&lt;Input,Output,State&gt;::NumberOfIterations()<font class="keyword"> const </font>
01808 <font class="keyword">  </font>{ <font class="keywordflow">return</font> total_iterations; }
01809 
01810 
01820   template &lt;class Input, class Output, class State&gt;
<a name="l01821"></a><a class="code" href="class_easylocal__MultiRunnerSolver.html#b0">01821</a>   MultiRunnerSolver&lt;Input,Output,State&gt;::MultiRunnerSolver(StateManager&lt;Input,State&gt;* sm, OutputManager&lt;Input,Output,State&gt;* om, Input* in, Output* out)
01822     : LocalSearchSolver&lt;Input,Output,State&gt;(sm,om,in,out), 
01823     total_iterations(0)
01824   { runners.clear(); }
01825 
01832   template &lt;class Input, class Output, class State&gt;
<a name="l01833"></a><a class="code" href="class_easylocal__MultiRunnerSolver.html#a2">01833</a>   <font class="keywordtype">void</font> MultiRunnerSolver&lt;Input,Output,State&gt;::SetRunner(Runner&lt;Input,State&gt; *r, <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i)<font class="keyword"> </font>
01834 <font class="keyword">  </font>{ 
01835     assert(i &lt; runners.size());
01836     runners[i] = r; 
01837   }
01838 
01844   template &lt;class Input, class Output, class State&gt;
<a name="l01845"></a><a class="code" href="class_easylocal__MultiRunnerSolver.html#a1">01845</a>   <font class="keywordtype">void</font> MultiRunnerSolver&lt;Input,Output,State&gt;::AddRunner(Runner&lt;Input,State&gt; *r)<font class="keyword"></font>
01846 <font class="keyword">  </font>{ runners.push_back(r); }
01847 
01851   template &lt;class Input, class Output, class State&gt;
<a name="l01852"></a><a class="code" href="class_easylocal__MultiRunnerSolver.html#a0">01852</a>   <font class="keywordtype">void</font> MultiRunnerSolver&lt;Input,Output,State&gt;::ClearRunners()<font class="keyword"></font>
01853 <font class="keyword">  </font>{ runners.clear(); }
01854 
01859   template &lt;class Input, class Output, class State&gt;
<a name="l01860"></a><a class="code" href="class_easylocal__ComparativeSolver.html#b1">01860</a>   <font class="keywordtype">void</font> ComparativeSolver&lt;Input,Output,State&gt;::Run()<font class="keyword"></font>
01861 <font class="keyword">  </font>{ 
01862     <font class="keywordtype">int</font> i;
01863     start_state = internal_state;
01864     runners[0]-&gt;SetCurrentState(start_state);
01865     runners[0]-&gt;Go();
01866     runners[0]-&gt;ComputeCost();
01867     internal_state = runners[0]-&gt;GetBestState();
01868     internal_state_cost = runners[0]-&gt;BestStateCost();
01869         
01870     <font class="keywordflow">for</font> (i = 1; i &lt; runners.size(); i++)
01871       {
01872         runners[i]-&gt;SetCurrentState(start_state);
01873         runners[i]-&gt;Go();
01874         runners[i]-&gt;ComputeCost();
01875         total_iterations += runners[i]-&gt;NumberOfIterations();
01876         <font class="keywordflow">if</font> (runners[i]-&gt;BestStateCost() &lt; internal_state_cost)
01877           {
01878             internal_state = runners[i]-&gt;GetBestState();
01879             internal_state_cost = runners[i]-&gt;BestStateCost();
01880           }
01881       }
01882   }
01883 
01889   template &lt;class Input, class Output, class State&gt;
<a name="l01890"></a><a class="code" href="class_easylocal__TokenRingSolver.html#a0">01890</a>   <font class="keywordtype">void</font> TokenRingSolver&lt;Input,Output,State&gt;::SetRounds(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> r)<font class="keyword"> </font>
01891 <font class="keyword">  </font>{ max_idle_rounds = r; }
01892 
01898   template &lt;class Input, class Output, class State&gt;
<a name="l01899"></a><a class="code" href="class_easylocal__TokenRingSolver.html#a1">01899</a>   <font class="keywordtype">void</font> TokenRingSolver&lt;Input,Output,State&gt;::SetStartRunner(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i)<font class="keyword"></font>
01900 <font class="keyword">  </font>{ start_runner = i; }
01901 
01902 
01912   template &lt;class Input, class Output, class State&gt;
<a name="l01913"></a><a class="code" href="class_easylocal__TokenRingSolver.html#b0">01913</a>   TokenRingSolver&lt;Input,Output,State&gt;::TokenRingSolver(StateManager&lt;Input,State&gt;* sm, OutputManager&lt;Input,Output,State&gt;* om, Input* in, Output* out) 
01914     : MultiRunnerSolver&lt;Input,Output,State&gt;(sm,om,in,out), 
01915     max_idle_rounds(1) 
01916   {}
01917 
01922   template &lt;class Input, class Output, class State&gt;
<a name="l01923"></a><a class="code" href="class_easylocal__TokenRingSolver.html#a2">01923</a>   <font class="keywordtype">void</font> TokenRingSolver&lt;Input,Output,State&gt;::Check()<font class="keyword"></font>
01924 <font class="keyword">  </font>{
01925     LocalSearchSolver&lt;Input,Output,State&gt;::Check();
01926     <font class="keywordflow">for</font> (<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; runners.size(); i++)
01927       {
01928         runners[i]-&gt;Check();
01929         assert(runners[i]-&gt;<a class="code" href="class_easylocal__Solver.html#a2">GetInput</a>() == p_in);
01930       }
01931   }
01932 
01938   template &lt;class Input, class Output, class State&gt;
<a name="l01939"></a><a class="code" href="class_easylocal__TokenRingSolver.html#a3">01939</a>   <font class="keywordtype">void</font> TokenRingSolver&lt;Input,Output,State&gt;::Print(std::ostream&amp; os)<font class="keyword"> const</font>
01940 <font class="keyword">  </font>{
01941     os &lt;&lt; <font class="stringliteral">"Solver State"</font> &lt;&lt; std::endl;
01942     <font class="keywordflow">for</font> (<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; runners.size(); i++)
01943       {
01944         os &lt;&lt; <font class="stringliteral">"Runner "</font> &lt;&lt; i &lt;&lt; std::endl;
01945         runners[i]-&gt;Print(os);
01946       }
01947   }
01948 
01953   template &lt;class Input, class Output, class State&gt;
<a name="l01954"></a><a class="code" href="class_easylocal__TokenRingSolver.html#b1">01954</a>   <font class="keywordtype">void</font> TokenRingSolver&lt;Input,Output,State&gt;::Run()<font class="keyword"></font>
01955 <font class="keyword">  </font>{
01956     assert(start_runner &lt; runners.size());
01957         
01958     <font class="comment">// i is the current runner, j is the previous one;</font>
01959     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = start_runner, j = (start_runner &gt;= 1) ?
01960       (start_runner - 1) : runners.size() - 1;
01961     <font class="keywordtype">int</font> idle_rounds = 0;
01962     <font class="keywordtype">bool</font> interrupt_search = <font class="keyword">false</font>;
01963     <font class="keywordtype">bool</font> improvement_found = <font class="keyword">false</font>;
01964         
01965     <a class="code" href="class_easylocal__LocalSearchSolver.html#b5">ComputeCost</a>(); <font class="comment">// Set internal_state_cost</font>
01966     <font class="comment">// internal_state_cost is used to check</font>
01967     <font class="comment">// whether a full round has produces improvements or not</font>
01968     runners[i]-&gt;SetCurrentState(internal_state);
01969         
01970     <font class="keywordflow">while</font> (idle_rounds &lt; max_idle_rounds &amp;&amp; !interrupt_search)
01971       { 
01972         <font class="keywordflow">do</font>
01973           {
01974             runners[i]-&gt;Go();
01975             <font class="keywordflow">if</font> (runners[i]-&gt;BestStateCost() &lt; internal_state_cost) 
01976               { 
01977                 internal_state = runners[i]-&gt;GetBestState(); 
01978                 internal_state_cost = runners[i]-&gt;BestStateCost(); 
01979                 improvement_found = <font class="keyword">true</font>;
01980               } 
01981             total_iterations += runners[i]-&gt;NumberOfIterations();
01982             <font class="keywordflow">if</font> (runners[i]-&gt;LowerBoundReached() || runners.size() == 1)
01983               {
01984                 interrupt_search = <font class="keyword">true</font>;
01985                 <font class="keywordflow">break</font>;
01986               }
01987             j = i;
01988             i = (i + 1) % runners.size();
01989             runners[i]-&gt;SetCurrentState(runners[j]-&gt;GetBestState());
01990           }
01991         <font class="keywordflow">while</font> (i != start_runner);
01992                 
01993         <font class="keywordflow">if</font> (!interrupt_search)
01994           {
01995             <font class="keywordflow">if</font> (improvement_found)
01996               idle_rounds = 0;
01997             <font class="keywordflow">else</font>
01998               idle_rounds++;
01999             improvement_found = <font class="keyword">false</font>;
02000           }
02001       }
02002   }
02003 
02004   <font class="comment">// Abstract Move Tester</font>
02005 
02011   template &lt;class Input, class Output, class State&gt;
<a name="l02012"></a><a class="code" href="class_easylocal__AbstractMoveTester.html#a0">02012</a>   AbstractMoveTester&lt;Input,Output,State&gt;::AbstractMoveTester(std::string s)<font class="keyword"> </font>
02013 <font class="keyword">  </font>{ name = s; }
02014 
02019   template &lt;class Input, class Output, class State&gt;
<a name="l02020"></a><a class="code" href="class_easylocal__AbstractMoveTester.html#a2">02020</a>   std::string AbstractMoveTester&lt;Input,Output,State&gt;::Name()<font class="keyword"> </font>
02021 <font class="keyword">  </font>{ <font class="keywordflow">return</font> name; }
02022 
02023   <font class="comment">// Move Tester</font>
02024 
02036   template &lt;class Input, class Output, class State, class Move&gt;
<a name="l02037"></a><a class="code" href="class_easylocal__MoveTester.html#a0">02037</a>   MoveTester&lt;Input,Output,State,Move&gt;::MoveTester(StateManager&lt;Input,State&gt;* sm, OutputManager&lt;Input,Output,State&gt;* om, NeighborhoodExplorer&lt;Input,State,Move&gt;* ne, std::string nm, Input* in)
02038     : AbstractMoveTester&lt;Input,Output,State&gt;(nm)
02039   { 
02040     <font class="keywordflow">if</font> (in != NULL)
02041       out.SetInput(in);
02042     p_in = in; 
02043     p_sm = sm; 
02044     p_om = om;
02045     p_nhe = ne; 
02046   }  
02047 
02053   template &lt;class Input, class Output, class State, class Move&gt;
<a name="l02054"></a><a class="code" href="class_easylocal__MoveTester.html#a2">02054</a>   <font class="keywordtype">void</font> MoveTester&lt;Input,Output,State,Move&gt;::SetInput(Input* in)<font class="keyword"></font>
02055 <font class="keyword">  </font>{
02056     p_in = in;
02057     out.SetInput(in);
02058     p_nhe-&gt;SetInput(in);
02059   }
02060 
02066   template &lt;class Input, class Output, class State, class Move&gt;
<a name="l02067"></a><a class="code" href="class_easylocal__MoveTester.html#a1">02067</a>   <font class="keywordtype">void</font> MoveTester&lt;Input,Output,State,Move&gt;::RunTestMenu(State&amp; st)<font class="keyword"></font>
02068 <font class="keyword">  </font>{
02069     <font class="keywordflow">do</font>
02070       {
02071         <a class="code" href="class_easylocal__MoveTester.html#b0">ShowMenu</a>();
02072         <font class="keywordflow">if</font> (choice != 0)
02073           {
02074             clock_t start_t = clock();
02075             <a class="code" href="class_easylocal__MoveTester.html#b1">ExecuteChoice</a>(st);
02076             clock_t end_t = clock();
02077             <font class="keywordtype">double</font> eltime = (end_t - start_t)/(<font class="keywordtype">double</font>)CLOCKS_PER_SEC;
02078             p_om-&gt;OutputState(st,out);
02079             std::cout &lt;&lt; <font class="stringliteral">"CURRENT SOLUTION "</font> &lt;&lt; std::endl &lt;&lt; out &lt;&lt; std::endl;
02080             std::cout &lt;&lt; <font class="stringliteral">"CURRENT COST : "</font> &lt;&lt; p_sm-&gt;CostFunction(st) &lt;&lt; std::endl;
02081             std::cout &lt;&lt; <font class="stringliteral">"ELAPSED TIME : "</font> &lt;&lt; eltime &lt;&lt; <font class="stringliteral">"s"</font> &lt;&lt; std::endl;
02082           }
02083       }
02084     <font class="keywordflow">while</font> (choice != 0);
02085     std::cout &lt;&lt; <font class="stringliteral">"Leaving move menu"</font> &lt;&lt; std::endl;
02086   }
02087 
02091   template &lt;class Input, class Output, class State, class Move&gt;
<a name="l02092"></a><a class="code" href="class_easylocal__MoveTester.html#b0">02092</a>   <font class="keywordtype">void</font> MoveTester&lt;Input,Output,State,Move&gt;::ShowMenu()<font class="keyword"></font>
02093 <font class="keyword">  </font>{ 
02094     std::cout &lt;&lt; <font class="stringliteral">"Move Menu: "</font> &lt;&lt; std::endl
02095               &lt;&lt; <font class="stringliteral">"     (1)  Best"</font> &lt;&lt; std::endl     
02096               &lt;&lt; <font class="stringliteral">"     (2)  Random"</font> &lt;&lt; std::endl
02097               &lt;&lt; <font class="stringliteral">"     (3)  Input"</font> &lt;&lt; std::endl
02098               &lt;&lt; <font class="stringliteral">"     (4)  Print Neighborhood statistics"</font> &lt;&lt; std::endl
02099               &lt;&lt; <font class="stringliteral">"     (5)  Check Move Info"</font> &lt;&lt; std::endl
02100               &lt;&lt; <font class="stringliteral">"     (0)  Return to Main Menu"</font> &lt;&lt; std::endl
02101               &lt;&lt; <font class="stringliteral">" Your choice: "</font>;
02102     std::cin &gt;&gt; choice;
02103   }
02104 
02110   template &lt;class Input, class Output, class State, class Move&gt;
<a name="l02111"></a><a class="code" href="class_easylocal__MoveTester.html#b1">02111</a>   <font class="keywordtype">void</font> MoveTester&lt;Input,Output,State,Move&gt;::ExecuteChoice(State&amp; st)<font class="keyword"></font>
02112 <font class="keyword">  </font>{
02113     Move mv;
02114     <font class="keywordflow">switch</font>(choice)
02115       { 
02116       <font class="keywordflow">case</font> 1: 
02117         p_nhe-&gt;BestMove(st,mv);
02118         <font class="keywordflow">break</font>;
02119       <font class="keywordflow">case</font> 2: 
02120         p_nhe-&gt;RandomMove(st,mv);
02121         <font class="keywordflow">break</font>;
02122       <font class="keywordflow">case</font> 3:      
02123         std::cout &lt;&lt; <font class="stringliteral">"Input move : "</font>;
02124         std::cin &gt;&gt; mv;
02125         <font class="keywordflow">break</font>;
02126       <font class="keywordflow">case</font> 4: 
02127         p_nhe-&gt;NeighborhoodStatistics(st);
02128         <font class="keywordflow">break</font>;
02129       <font class="keywordflow">case</font> 5: 
02130         {
02131           <font class="keywordtype">char</font> ch;
02132           std::cout &lt;&lt; <font class="stringliteral">"Random move (y/n)? "</font>;
02133           std::cin &gt;&gt; ch;
02134           <font class="keywordflow">if</font> (ch == <font class="charliteral">'y'</font> || ch == <font class="charliteral">'Y'</font>)
02135             p_nhe-&gt;RandomMove(st,mv);
02136           <font class="keywordflow">else</font>
02137             {
02138               std::cout &lt;&lt; <font class="stringliteral">"Input move : "</font>;
02139               std::cin &gt;&gt; mv;
02140             }
02141           std::cout &lt;&lt; <font class="stringliteral">"Move info"</font> &lt;&lt; std::endl;
02142           p_nhe-&gt;PrintMoveInfo(st,mv,std::cout);
02143           <font class="keywordflow">break</font>;
02144         }
02145       <font class="keywordflow">default</font>:
02146         std::cout &lt;&lt; <font class="stringliteral">"Invalid choice"</font> &lt;&lt; std::endl;
02147       }
02148     <font class="keywordflow">if</font> (choice == 1 || choice == 2 || choice == 3)
02149       {
02150         std::cout &lt;&lt; <font class="stringliteral">"Move : "</font> &lt;&lt; mv &lt;&lt; std::endl;
02151         <font class="keywordflow">if</font> (p_nhe-&gt;FeasibleMove(st,mv))
02152           p_nhe-&gt;MakeMove(st,mv);
02153         <font class="keywordflow">else</font>
02154           std::cout &lt;&lt; <font class="stringliteral">"Infeasible move!"</font> &lt;&lt; std::endl;
02155       }
02156   }
02157 
02158   <font class="comment">// State Tester</font>
02159 
02168   template &lt;class Input, class Output, class State&gt;
<a name="l02169"></a><a class="code" href="class_easylocal__StateTester.html#a0">02169</a>   StateTester&lt;Input,Output,State&gt;::StateTester(StateManager&lt;Input,State&gt;* s, OutputManager&lt;Input,Output,State&gt;* o, Input* in)
02170     : p_sm(s), p_om(o), p_in(in)
02171   {
02172     <font class="keywordflow">if</font> (in != NULL)
02173       out.SetInput(in); 
02174   }
02175 
02181   template &lt;class Input, class Output, class State&gt;
<a name="l02182"></a><a class="code" href="class_easylocal__StateTester.html#a4">02182</a>   <font class="keywordtype">void</font> StateTester&lt;Input,Output,State&gt;::SetInput(Input* in)<font class="keyword"></font>
02183 <font class="keyword">  </font>{
02184     p_in = in;
02185     out.SetInput(in);
02186   }
02187 
02193   template &lt;class Input, class Output, class State&gt;
<a name="l02194"></a><a class="code" href="class_easylocal__StateTester.html#a2">02194</a>   <font class="keywordtype">void</font> StateTester&lt;Input,Output,State&gt;::RunTestMenu(State&amp; st)<font class="keyword"></font>
02195 <font class="keyword">  </font>{
02196     <a class="code" href="class_easylocal__StateTester.html#b0">ShowMenu</a>();    
02197     clock_t start_t = clock();
02198     <a class="code" href="class_easylocal__StateTester.html#b2">ExecuteChoice</a>(st);
02199     clock_t end_t = clock();
02200     <font class="keywordtype">double</font> eltime = (end_t - start_t)/(<font class="keywordtype">double</font>)CLOCKS_PER_SEC;
02201     <font class="keywordflow">if</font> (choice != 4 &amp;&amp; choice != 5 &amp;&amp; choice != 6 &amp;&amp; choice != 7) <font class="comment">// choices 4-7 do not change the state</font>
02202       {
02203         p_om-&gt;OutputState(st,out);
02204         std::cout &lt;&lt; <font class="stringliteral">"CURRENT SOLUTION "</font> &lt;&lt; std::endl &lt;&lt; out &lt;&lt; std::endl;
02205         std::cout &lt;&lt; <font class="stringliteral">"CURRENT COST : "</font> &lt;&lt; p_sm-&gt;CostFunction(st) &lt;&lt; std::endl;
02206         std::cout &lt;&lt; <font class="stringliteral">"ELAPSED TIME : "</font> &lt;&lt; eltime &lt;&lt; <font class="stringliteral">"s"</font> &lt;&lt; std::endl;
02207       }
02208   }
02209 
02213   template &lt;class Input, class Output, class State&gt;
<a name="l02214"></a><a class="code" href="class_easylocal__StateTester.html#a3">02214</a>   <font class="keywordtype">void</font> StateTester&lt;Input,Output,State&gt;::RunInputMenu(State&amp; st)<font class="keyword"></font>
02215 <font class="keyword">  </font>{
02216     <a class="code" href="class_easylocal__StateTester.html#b1">ShowReducedMenu</a>();
02217     clock_t start_t = clock();
02218     <a class="code" href="class_easylocal__StateTester.html#b2">ExecuteChoice</a>(st);
02219     clock_t end_t = clock();
02220     <font class="keywordtype">double</font> eltime = (end_t - start_t)/(<font class="keywordtype">double</font>)CLOCKS_PER_SEC;
02221     p_om-&gt;OutputState(st,out);
02222     std::cout &lt;&lt; <font class="stringliteral">"INITIAL SOLUTION "</font> &lt;&lt; std::endl &lt;&lt; out &lt;&lt; std::endl;
02223     std::cout &lt;&lt; <font class="stringliteral">"INITIAL COST : "</font> &lt;&lt; p_sm-&gt;CostFunction(st) &lt;&lt; std::endl;
02224     std::cout &lt;&lt; <font class="stringliteral">"ELAPSED TIME : "</font> &lt;&lt; eltime &lt;&lt; <font class="stringliteral">"s"</font> &lt;&lt; std::endl;
02225   }
02226 
02230   template &lt;class Input, class Output, class State&gt;
<a name="l02231"></a><a class="code" href="class_easylocal__StateTester.html#b0">02231</a>   <font class="keywordtype">void</font> StateTester&lt;Input,Output,State&gt;::ShowMenu()<font class="keyword"></font>
02232 <font class="keyword">  </font>{
02233     std::cout &lt;&lt; <font class="stringliteral">"State Menu: "</font> &lt;&lt; std::endl
02234               &lt;&lt; <font class="stringliteral">"    (1) Random state "</font> &lt;&lt; std::endl
02235               &lt;&lt; <font class="stringliteral">"    (2) Sample state"</font> &lt;&lt; std::endl
02236               &lt;&lt; <font class="stringliteral">"    (3) Read from file"</font> &lt;&lt; std::endl
02237               &lt;&lt; <font class="stringliteral">"    (4) Write to file"</font> &lt;&lt; std::endl
02238               &lt;&lt; <font class="stringliteral">"    (5) Show state"</font> &lt;&lt; std::endl
02239               &lt;&lt; <font class="stringliteral">"    (6) Show input"</font> &lt;&lt; std::endl
02240               &lt;&lt; <font class="stringliteral">"    (7) Show cost function components"</font> &lt;&lt; std::endl
02241               &lt;&lt; <font class="stringliteral">"Your choice : "</font>;
02242     std::cin &gt;&gt; choice;
02243   }
02244 
02248   template &lt;class Input, class Output, class State&gt;
<a name="l02249"></a><a class="code" href="class_easylocal__StateTester.html#b1">02249</a>   <font class="keywordtype">void</font> StateTester&lt;Input,Output,State&gt;::ShowReducedMenu()<font class="keyword"></font>
02250 <font class="keyword">  </font>{
02251     std::cout &lt;&lt; <font class="stringliteral">"Initial State Menu: "</font> &lt;&lt; std::endl
02252               &lt;&lt; <font class="stringliteral">"    (1) Random state "</font> &lt;&lt; std::endl
02253               &lt;&lt; <font class="stringliteral">"    (2) Sample state"</font> &lt;&lt; std::endl
02254               &lt;&lt; <font class="stringliteral">"    (3) Read from file"</font> &lt;&lt; std::endl
02255               &lt;&lt; <font class="stringliteral">"Your choice : "</font>;
02256     std::cin &gt;&gt; choice;
02257     <font class="keywordflow">if</font> (choice == 4 || choice == 5 || choice == 6) choice = -1; <font class="comment">// choices 4 and 5 do not belong to the reduces menu</font>
02258   }
02259 
02265   template &lt;class Input, class Output, class State&gt;
<a name="l02266"></a><a class="code" href="class_easylocal__StateTester.html#b2">02266</a>   <font class="keywordtype">void</font> StateTester&lt;Input,Output,State&gt;::ExecuteChoice(State&amp; st)<font class="keyword"></font>
02267 <font class="keyword">  </font>{
02268     <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> start_t, end_t;
02269     start_t = end_t = 0;
02270     <font class="keywordflow">switch</font>(choice)
02271       {
02272       <font class="keywordflow">case</font> 1: 
02273         start_t = clock();
02274         p_sm-&gt;RandomState(st);
02275         end_t = clock();
02276         <font class="keywordflow">break</font>;
02277       <font class="keywordflow">case</font> 2: 
02278         {
02279           <font class="keywordtype">int</font> samples;
02280           std::cout &lt;&lt; <font class="stringliteral">"How many samples : "</font>;
02281           std::cin &gt;&gt; samples;
02282           start_t = clock();
02283           p_sm-&gt;SampleState(st,samples);
02284           end_t = clock();
02285           <font class="keywordflow">break</font>;
02286         }
02287       <font class="keywordflow">case</font> 3:
02288         {
02289           std::string file_name;
02290           std::cout &lt;&lt; <font class="stringliteral">"File name : "</font>;
02291           std::cin &gt;&gt; file_name;
02292           std::ifstream is(file_name.c_str());
02293           p_om-&gt;ReadState(st,is);
02294           <font class="keywordflow">break</font>;
02295         }
02296       <font class="keywordflow">case</font> 4:
02297         {
02298           std::string file_name;
02299           std::cout &lt;&lt; <font class="stringliteral">"File name : "</font>;
02300           std::cin &gt;&gt; file_name;
02301           std::ofstream os(file_name.c_str());
02302           p_om-&gt;WriteState(st,os);
02303           <font class="keywordflow">break</font>;
02304         }
02305       <font class="keywordflow">case</font> 5:
02306         {
02307           p_sm-&gt;PrintState(st); 
02308           <font class="keywordflow">break</font>;
02309         }
02310       <font class="keywordflow">case</font> 6:
02311         {
02312           std::cout &lt;&lt; *p_in;
02313           <font class="keywordflow">break</font>;
02314         }
02315       <font class="keywordflow">case</font> 7:
02316         {
02317           std::cout &lt;&lt; std::endl &lt;&lt; <font class="stringliteral">"Violations: "</font> &lt;&lt; std::endl;
02318           p_sm-&gt;Violations(st);
02319           std::cout &lt;&lt; std::endl &lt;&lt; <font class="stringliteral">"Objective: "</font> &lt;&lt; std::endl;
02320           p_sm-&gt;Objective(st);
02321           <font class="keywordflow">break</font>;
02322         }
02323       <font class="keywordflow">default</font>:
02324         std::cout &lt;&lt; <font class="stringliteral">"Invalid choice"</font> &lt;&lt; std::endl;
02325       }
02326     <font class="keywordflow">if</font> (choice == 1 || choice == 2)
02327       std::cout &lt;&lt; <font class="stringliteral">"Time: "</font> &lt;&lt; (end_t - start_t)/(<font class="keywordtype">float</font>)CLOCKS_PER_SEC &lt;&lt; <font class="stringliteral">" secs"</font> &lt;&lt; std::endl;
02328   }
02329 
02330   <font class="comment">// Tester</font>
02331 
02338   template &lt;class Input, class Output, class State&gt;  
<a name="l02339"></a><a class="code" href="class_easylocal__Tester.html#a4">02339</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output, State&gt;::SetMoveTester(AbstractMoveTester&lt;Input,Output,State&gt;* p_amt, <font class="keywordtype">int</font> i)<font class="keyword"></font>
02340 <font class="keyword">  </font>{ assert(i &lt; move_testers.size()); move_testers[i] = p_amt; }
02341 
02347   template &lt;class Input, class Output, class State&gt;  
<a name="l02348"></a><a class="code" href="class_easylocal__Tester.html#a5">02348</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output, State&gt;::AddMoveTester(AbstractMoveTester&lt;Input,Output,State&gt;* p_amt)<font class="keyword"></font>
02349 <font class="keyword">  </font>{ move_testers.push_back(p_amt); }
02350 
02354   template &lt;class Input, class Output, class State&gt;  
<a name="l02355"></a><a class="code" href="class_easylocal__Tester.html#a6">02355</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output, State&gt;::CleanMoveTesters()<font class="keyword"></font>
02356 <font class="keyword">  </font>{ move_testers.clear(); }
02357 
02363   template &lt;class Input, class Output, class State&gt;  
<a name="l02364"></a><a class="code" href="class_easylocal__Tester.html#a7">02364</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output, State&gt;::SetStateTester(StateTester&lt;Input,Output,State&gt;* p_st)<font class="keyword"></font>
02365 <font class="keyword">  </font>{ state_tester = p_st; }
02366 
02375   template &lt;class Input, class Output, class State&gt;
<a name="l02376"></a><a class="code" href="class_easylocal__Tester.html#a0">02376</a>   Tester&lt;Input, Output, State&gt;::Tester(StateManager&lt;Input,State&gt;* sm, 
02377                                        OutputManager&lt;Input,Output,State&gt;* om,
02378                                        Input *in)
02379     : move_testers(0), runners(0), p_in(in)
02380   {
02381     <font class="keywordflow">if</font> (in != NULL)
02382       {
02383         test_state.SetInput(in); 
02384         out.SetInput(in);  
02385       }
02386     p_sm = sm;
02387     p_om = om;
02388     state_tester = NULL;
02389     solver = NULL;
02390     logstream = &amp;std::cerr;
02391     output_file_prefix = <font class="stringliteral">""</font>;
02392     plot_file_prefix = <font class="stringliteral">""</font>;
02393   }
02394 
02400   template &lt;class Input, class Output, class State&gt;
<a name="l02401"></a><a class="code" href="class_easylocal__Tester.html#a3">02401</a>   <font class="keywordtype">void</font> Tester&lt;Input,Output,State&gt;::SetInput(Input* in)<font class="keyword"></font>
02402 <font class="keyword">  </font>{
02403     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i;
02404 
02405     p_in = in; 
02406     p_sm-&gt;SetInput(in);
02407     p_om-&gt;SetInput(in);
02408     test_state.SetInput(in);
02409     state_tester-&gt;SetInput(in);
02410     out.SetInput(in);
02411     <font class="keywordflow">if</font> (solver != NULL) 
02412       solver-&gt;SetInput(in);
02413     <font class="keywordflow">for</font> (i = 0; i &lt; runners.size(); i++)
02414       <font class="keywordflow">if</font> (runners[i] != NULL) 
02415         runners[i]-&gt;SetInput(in);
02416     <font class="keywordflow">for</font> (i = 0; i &lt; move_testers.size(); i++)
02417       move_testers[i]-&gt;SetInput(in);
02418   }
02419 
02424   template &lt;class Input, class Output, class State&gt;
<a name="l02425"></a><a class="code" href="class_easylocal__Tester.html#a19">02425</a>   <font class="keywordtype">void</font>  Tester&lt;Input,Output,State&gt;::Check()<font class="keyword"></font>
02426 <font class="keyword">  </font>{
02427     assert(p_sm-&gt;GetInput() == p_in);
02428     assert(p_om-&gt;GetInput() == p_in);
02429     solver-&gt;Check();
02430     assert(solver-&gt;GetInput() == p_in);
02431     <font class="keywordflow">for</font> (<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; runners.size(); i++)
02432       {
02433         runners[i]-&gt;Check();
02434         assert(runners[i]-&gt;GetInput() == p_in);
02435       }
02436   }
02437 
02443   template &lt;class Input, class Output, class State&gt;
<a name="l02444"></a><a class="code" href="class_easylocal__Tester.html#a20">02444</a>   <font class="keywordtype">void</font>  Tester&lt;Input,Output,State&gt;::Print(std::ostream&amp; os)<font class="keyword"> const</font>
02445 <font class="keyword">  </font>{
02446     os &lt;&lt; <font class="stringliteral">"Tester State"</font> &lt;&lt; std::endl;
02447     <font class="keywordflow">for</font> (<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; runners.size(); i++)
02448       {
02449         os &lt;&lt; <font class="stringliteral">"Runner "</font> &lt;&lt; i &lt;&lt; std::endl;
02450         runners[i]-&gt;Print(os);
02451       }
02452     solver-&gt;Print(os);
02453   }
02454 
02460   template &lt;class Input, class Output, class State&gt;
<a name="l02461"></a><a class="code" href="class_easylocal__Tester.html#a11">02461</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output, State&gt;::SetSolver(TokenRingSolver&lt;Input,Output,State&gt;* p_so)<font class="keyword"></font>
02462 <font class="keyword">  </font>{ 
02463     solver = p_so; 
02464     <font class="keywordflow">if</font> (p_in != NULL &amp;&amp; p_in != solver-&gt;GetInput())
02465       solver-&gt;SetInput(p_in);
02466     <font class="keywordflow">if</font> (&amp;out != solver-&gt;GetOutput())
02467       solver-&gt;SetOutput(&amp;out);
02468   }
02469 
02476   template &lt;class Input, class Output, class State&gt;
<a name="l02477"></a><a class="code" href="class_easylocal__Tester.html#a12">02477</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output, State&gt;::SetSolverParameters(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> rounds, <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> start_runner)<font class="keyword"> </font>
02478 <font class="keyword">  </font>{
02479     assert(solver != NULL);
02480     solver-&gt;SetRounds(rounds);
02481     solver-&gt;SetStartRunner(start_runner);
02482   }  
02483 
02487   template &lt;class Input, class Output, class State&gt;
<a name="l02488"></a><a class="code" href="class_easylocal__Tester.html#a8">02488</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output, State&gt;::CleanRunners()<font class="keyword"></font>
02489 <font class="keyword">  </font>{ 
02490     runners.clear();
02491   }
02492 
02500   template &lt;class Input, class Output, class State&gt;
<a name="l02501"></a><a class="code" href="class_easylocal__Tester.html#a9">02501</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output, State&gt;::SetRunner(Runner&lt;Input,State&gt;* p_ru, <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i)<font class="keyword"></font>
02502 <font class="keyword">  </font>{ 
02503     runners[i] = p_ru; 
02504     <font class="keywordflow">if</font> (p_in != NULL)
02505       runners[i]-&gt;SetInput(p_in);
02506   }
02507 
02513   template &lt;class Input, class Output, class State&gt;
<a name="l02514"></a><a class="code" href="class_easylocal__Tester.html#a10">02514</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output, State&gt;::AddRunner(Runner&lt;Input,State&gt;* p_ru)<font class="keyword"></font>
02515 <font class="keyword">  </font>{ 
02516     assert(p_ru != NULL);
02517     <font class="keywordflow">if</font> (p_in != p_ru-&gt;GetInput())
02518       p_ru-&gt;SetInput(p_in);
02519     runners.push_back(p_ru);
02520   }
02521 
02525   template &lt;class Input, class Output, class State&gt;
<a name="l02526"></a><a class="code" href="class_easylocal__Tester.html#a18">02526</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output, State&gt;::CleanSolver()<font class="keyword"> </font>
02527 <font class="keyword">  </font>{ 
02528     assert(solver != NULL); 
02529     solver-&gt;ClearRunners(); 
02530   }
02531 
02539   template &lt;class Input, class Output, class State&gt;
<a name="l02540"></a><a class="code" href="class_easylocal__Tester.html#a14">02540</a>   <font class="keywordtype">int</font> Tester&lt;Input, Output, State&gt;::AddRunnerToSolver(std::string name, std::string type)<font class="keyword"></font>
02541 <font class="keyword">  </font>{
02542     assert(solver != NULL);
02543     <font class="keywordtype">bool</font> found = <font class="keyword">false</font>, type_mismatch;
02544     <font class="keywordflow">for</font> (<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; runners.size(); i++)
02545       <font class="keywordflow">if</font> (name == runners[i]-&gt;Name())
02546         {
02547           found = <font class="keyword">true</font>;
02548           <font class="keywordflow">if</font> (type == runners[i]-&gt;Type()) 
02549             {
02550               type_mismatch = <font class="keyword">false</font>;
02551               solver-&gt;AddRunner(runners[i]);      
02552             }
02553           <font class="keywordflow">else</font>
02554             type_mismatch = <font class="keyword">true</font>;
02555           <font class="keywordflow">break</font>;
02556         }
02557     <font class="keywordflow">if</font> (found)
02558       <font class="keywordflow">if</font> (!type_mismatch)
02559         <font class="keywordflow">return</font> 0;
02560       <font class="keywordflow">else</font>
02561         <font class="keywordflow">return</font> RUNNER_TYPE_MISMATCH;
02562     <font class="keywordflow">else</font>
02563       <font class="keywordflow">return</font> RUNNER_NOT_FOUND;
02564   }
02565 
02574   template &lt;class Input, class Output, class State&gt;
<a name="l02575"></a><a class="code" href="class_easylocal__Tester.html#a15">02575</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output, State&gt;::SetRunningParameters(std::string name, std::string type, <font class="keyword">const</font> ParameterBox&amp; pb)<font class="keyword"></font>
02576 <font class="keyword">  </font>{
02577     <font class="keywordtype">bool</font> found = <font class="keyword">false</font>;
02578     <font class="keywordflow">for</font> (<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; runners.size(); i++) 
02579       <font class="keywordflow">if</font> (name == runners[i]-&gt;Name()) 
02580         {
02581           runners[i]-&gt;SetParameters(pb);
02582           found = <font class="keyword">true</font>;
02583           <font class="keywordflow">break</font>;
02584         }
02585     assert(found);
02586   }
02587   
02591   template &lt;class Input, class Output, class State&gt;
<a name="l02592"></a><a class="code" href="class_easylocal__Tester.html#a16">02592</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output, State&gt;::StartSolver()<font class="keyword"></font>
02593 <font class="keyword">  </font>{ 
02594     <font class="keywordtype">double</font> avgtime = 0;
02595     fvalue avgcost = 0, avgviol = 0, avgobj = 0;
02596     assert(solver != NULL);
02597     *logstream &lt;&lt; <font class="stringliteral">"Run\t"</font> &lt;&lt; <font class="stringliteral">"elapsed time\t"</font> &lt;&lt; <font class="stringliteral">"cost \t"</font> &lt;&lt; <font class="stringliteral">"violations\t"</font> &lt;&lt; <font class="stringliteral">"objective\t"</font> &lt;&lt; std::endl;
02598     *logstream &lt;&lt; <font class="stringliteral">"--------------------------------------------------------------------------"</font> &lt;&lt; std::endl;
02599     <font class="keywordflow">for</font> (<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 1; i &lt;= trials; i++)
02600       {
02601         <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> start_t = clock();
02602         solver-&gt;Solve();
02603         <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> end_t = clock();      
02604         <font class="keywordtype">double</font> eltime = (end_t - start_t)/(<font class="keywordtype">double</font>)CLOCKS_PER_SEC;
02605         p_om-&gt;InputState(test_state,out);
02606         <font class="comment">// writing the output in a output file</font>
02607         <font class="keywordflow">if</font> (output_file_prefix != <font class="stringliteral">""</font>)
02608           {
02609             std::string fn(output_file_prefix);
02610             <font class="keywordtype">char</font>* trial = <font class="keyword">new</font> <font class="keywordtype">char</font>[(<font class="keywordtype">int</font>)ceil(log10(i))+1];
02611             sprintf(trial,<font class="stringliteral">"%d"</font>,i);
02612             fn += <font class="charliteral">'-'</font> + std::string(trial) + std::string(<font class="stringliteral">".out"</font>);
02613             std::ofstream os(fn.c_str(),std::ios::out);
02614             os &lt;&lt; out;
02615             <font class="keyword">delete</font> trial;
02616           }      
02617         fvalue cost = p_sm-&gt;CostFunction(test_state);
02618         fvalue viol = p_sm-&gt;Violations(test_state);
02619         fvalue obj = p_sm-&gt;Objective(test_state);
02620         *logstream &lt;&lt; i &lt;&lt; <font class="stringliteral">"\t"</font> &lt;&lt; eltime &lt;&lt; <font class="stringliteral">"\t\t"</font> 
02621                    &lt;&lt; cost &lt;&lt; <font class="stringliteral">"\t"</font> &lt;&lt; viol &lt;&lt; <font class="stringliteral">"\t\t"</font> &lt;&lt; obj &lt;&lt; std::endl;      
02622         avgtime += eltime;
02623         avgcost += cost;
02624         avgviol += viol;
02625         avgobj += obj;
02626       }
02627         
02628     avgtime /= trials; avgcost /= trials; avgviol /= trials; avgobj /= trials;
02629     *logstream &lt;&lt; <font class="stringliteral">"--------------------------------------------------------------------------"</font> &lt;&lt; std::endl;
02630     *logstream &lt;&lt; <font class="stringliteral">"Avg:\t"</font> &lt;&lt; avgtime &lt;&lt; <font class="stringliteral">"\t\t"</font> &lt;&lt; avgcost &lt;&lt; <font class="stringliteral">"\t"</font> &lt;&lt; avgviol &lt;&lt; <font class="stringliteral">"\t\t"</font> &lt;&lt; avgobj &lt;&lt; std::endl;
02631   }
02632 
02638   template &lt;class Input, class Output, class State&gt;
<a name="l02639"></a><a class="code" href="class_easylocal__Tester.html#a13">02639</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output, State&gt;::LoadInstance(std::string id)<font class="keyword"> </font>
02640 <font class="keyword">  </font>{
02641     *logstream &lt;&lt; <font class="stringliteral">"Instance: "</font> &lt;&lt; id &lt;&lt; std::endl;
02642     <a class="code" href="class_easylocal__Tester.html#a18">CleanSolver</a>();  
02643     p_in-&gt;Load(id);
02644     <a class="code" href="class_easylocal__Tester.html#a3">SetInput</a>(p_in);
02645   }
02646 
02652   template &lt;class Input, class Output, class State&gt;
<a name="l02653"></a><a class="code" href="class_easylocal__Tester.html#a17">02653</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output, State&gt;::ProcessBatch(std::string filename)<font class="keyword"> </font>
02654 <font class="keyword">  </font>{ 
02655     <font class="keywordflow">if</font> (yyin = fopen(filename.c_str(), <font class="stringliteral">"r"</font>))
02656       {
02657         yyout = stdout;
02658         <a class="code" href="EasyLocal_h.html#a4">yyparse</a>();
02659         fclose(yyin);
02660       }
02661     <font class="keywordflow">else</font>
02662       std::cerr &lt;&lt; <font class="stringliteral">"Error: "</font> &lt;&lt; filename &lt;&lt; <font class="stringliteral">" file not found"</font> &lt;&lt; std::endl;
02663   }
02664 
02665   
02670   template &lt;class Input, class Output, class State&gt;
<a name="l02671"></a><a class="code" href="class_easylocal__Tester.html#a2">02671</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output, State&gt;::RunMainMenu()<font class="keyword"></font>
02672 <font class="keyword">  </font>{
02673     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i;
02674     assert(state_tester != NULL);
02675     <font class="keywordflow">for</font> (i = 0; i &lt; move_testers.size(); i++)
02676       assert(move_testers[i] != NULL);
02677     <font class="keywordflow">for</font> (i = 0; i &lt; runners.size(); i++)
02678       assert(runners[i] != NULL);
02679         
02680     state_tester-&gt;RunInputMenu(test_state);
02681         
02682     <font class="keywordflow">do</font>
02683       {
02684         <a class="code" href="class_easylocal__Tester.html#b0">ShowMainMenu</a>();
02685         <font class="keywordflow">if</font> (choice != 0)
02686           <a class="code" href="class_easylocal__Tester.html#b4">ExecuteMainChoice</a>();
02687       }
02688     <font class="keywordflow">while</font> (choice != 0);
02689     std::cout &lt;&lt; <font class="stringliteral">"Bye bye..."</font> &lt;&lt; std::endl;
02690   }
02691 
02695   template &lt;class Input, class Output, class State&gt;
<a name="l02696"></a><a class="code" href="class_easylocal__Tester.html#b0">02696</a>   <font class="keywordtype">void</font> Tester&lt;Input,Output, State&gt;::ShowMainMenu()<font class="keyword"></font>
02697 <font class="keyword">  </font>{
02698     std::cout &lt;&lt; <font class="stringliteral">"MAIN MENU:"</font> &lt;&lt; std::endl
02699               &lt;&lt; <font class="stringliteral">"   (1) Move menu"</font> &lt;&lt; std::endl
02700               &lt;&lt; <font class="stringliteral">"   (2) Run menu"</font> &lt;&lt; std::endl
02701               &lt;&lt; <font class="stringliteral">"   (3) State menu"</font> &lt;&lt; std::endl
02702               &lt;&lt; <font class="stringliteral">"   (4) Process batch file"</font> &lt;&lt; std::endl
02703               &lt;&lt; <font class="stringliteral">"   (5) Debugging"</font> &lt;&lt; std::endl
02704               &lt;&lt; <font class="stringliteral">"   (0) Exit"</font> &lt;&lt; std::endl
02705               &lt;&lt; <font class="stringliteral">" Your choice: "</font>;
02706     std::cin &gt;&gt; choice;
02707   }
02708 
02712   template &lt;class Input, class Output, class State&gt;
<a name="l02713"></a><a class="code" href="class_easylocal__Tester.html#b3">02713</a>   <font class="keywordtype">void</font> Tester&lt;Input,Output, State&gt;::ShowDebuggingMenu()<font class="keyword"></font>
02714 <font class="keyword">  </font>{
02715     std::cout &lt;&lt; <font class="stringliteral">"DEBUGGING MENU:"</font> &lt;&lt; std::endl
02716               &lt;&lt; <font class="stringliteral">"   (1) Print tester status"</font> &lt;&lt; std::endl
02717               &lt;&lt; <font class="stringliteral">"   (2) Check tester status"</font> &lt;&lt; std::endl
02718               &lt;&lt; <font class="stringliteral">" Your choice: "</font>;
02719     std::cin &gt;&gt; choice;
02720   }
02721 
02725   template &lt;class Input, class Output, class State&gt;
<a name="l02726"></a><a class="code" href="class_easylocal__Tester.html#b7">02726</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output,State&gt;::ExecuteDebuggingMenu()<font class="keyword"></font>
02727 <font class="keyword">  </font>{
02728     <font class="keywordflow">switch</font>(choice)
02729       {
02730       <font class="keywordflow">case</font> 1: 
02731         <a class="code" href="class_easylocal__Tester.html#a20">Print</a>();
02732         <a class="code" href="class_easylocal__Tester.html#a19">Check</a>();
02733         <font class="keywordflow">break</font>;
02734       <font class="keywordflow">case</font> 2: 
02735         <a class="code" href="class_easylocal__Tester.html#a19">Check</a>();
02736         <font class="keywordflow">break</font>;
02737       <font class="keywordflow">default</font>:
02738         std::cout &lt;&lt; <font class="stringliteral">"Invalid choice"</font> &lt;&lt; std::endl;
02739       }
02740   }
02741 
02745   template &lt;class Input, class Output, class State&gt;
<a name="l02746"></a><a class="code" href="class_easylocal__Tester.html#b4">02746</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output,State&gt;::ExecuteMainChoice()<font class="keyword"></font>
02747 <font class="keyword">  </font>{
02748     <font class="keywordflow">switch</font>(choice)
02749       {
02750       <font class="keywordflow">case</font> 1: 
02751         <a class="code" href="class_easylocal__Tester.html#b1">ShowMovesMenu</a>();
02752         <a class="code" href="class_easylocal__Tester.html#b5">ExecuteMovesChoice</a>();
02753         <font class="keywordflow">break</font>;
02754       <font class="keywordflow">case</font> 2: 
02755         <a class="code" href="class_easylocal__Tester.html#b2">ShowRunMenu</a>();
02756         <a class="code" href="class_easylocal__Tester.html#b6">ExecuteRunChoice</a>();
02757         <font class="keywordflow">break</font>;
02758       <font class="keywordflow">case</font> 3: 
02759         state_tester-&gt;RunTestMenu(test_state);
02760         <font class="keywordflow">break</font>;
02761       <font class="keywordflow">case</font> 4:
02762         {
02763           std::string file_name;
02764           std::cout &lt;&lt; <font class="stringliteral">"Insert Batch File name : "</font>;
02765           std::cin &gt;&gt; file_name;
02766           <a class="code" href="class_easylocal__Tester.html#a17">ProcessBatch</a>(file_name);
02767           <font class="keywordflow">break</font>;
02768         }
02769       <font class="keywordflow">case</font> 5:
02770         <a class="code" href="class_easylocal__Tester.html#b3">ShowDebuggingMenu</a>();
02771         <a class="code" href="class_easylocal__Tester.html#b7">ExecuteDebuggingMenu</a>(); 
02772       <font class="keywordflow">case</font> 0:
02773         <font class="keywordflow">break</font>;
02774       <font class="keywordflow">default</font>:
02775         std::cout &lt;&lt; <font class="stringliteral">"Invalid choice"</font> &lt;&lt; std::endl;
02776       }
02777   }
02778 
02782   template &lt;class Input, class Output, class State&gt;
<a name="l02783"></a><a class="code" href="class_easylocal__Tester.html#b1">02783</a>   <font class="keywordtype">void</font> Tester&lt;Input, Output,State&gt;::ShowMovesMenu()<font class="keyword"></font>
02784 <font class="keyword">  </font>{
02785     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i;
02786     std::cout &lt;&lt; <font class="stringliteral">"MOVES MENU: "</font> &lt;&lt; std::endl;
02787     <font class="keywordflow">for</font> (i = 0; i &lt; move_testers.size(); i++)
02788       std::cout &lt;&lt; <font class="stringliteral">"   ("</font> &lt;&lt; i+1 &lt;&lt; <font class="stringliteral">") "</font> &lt;&lt; move_testers[i]-&gt;Name() &lt;&lt; std::endl;
02789     std::cout &lt;&lt; <font class="stringliteral">"   (0) Return to Main Menu"</font> &lt;&lt; std::endl;
02790     std::cout &lt;&lt; <font class="stringliteral">" Your choice: "</font>;
02791     std::cin &gt;&gt; sub_choice;
02792   }
02793 
02797   template &lt;class Input, class Output, class State&gt;
<a name="l02798"></a><a class="code" href="class_easylocal__Tester.html#b2">02798</a>   <font class="keywordtype">void</font> Tester&lt;Input,Output, State&gt;::ShowRunMenu()<font class="keyword"></font>
02799 <font class="keyword">  </font>{
02800     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i;
02801     std::cout &lt;&lt; <font class="stringliteral">"RUN MENU: "</font> &lt;&lt; std::endl;
02802     <font class="keywordflow">for</font> (i = 0; i &lt; runners.size(); i++)
02803       std::cout &lt;&lt; <font class="stringliteral">"   ("</font> &lt;&lt; i+1 &lt;&lt; <font class="stringliteral">") "</font> &lt;&lt; runners[i]-&gt;Name() &lt;&lt; <font class="stringliteral">" ["</font> &lt;&lt; runners[i]-&gt;Type() &lt;&lt; <font class="stringliteral">"]"</font> &lt;&lt; std::endl;
02804     std::cout &lt;&lt; <font class="stringliteral">"   (0) Return to Main Menu"</font> &lt;&lt; std::endl;
02805     std::cout &lt;&lt; <font class="stringliteral">" Your choice: "</font>;
02806     std::cin &gt;&gt; sub_choice;
02807   }
02808 
02812   template &lt;class Input, class Output, class State&gt;
<a name="l02813"></a><a class="code" href="class_easylocal__Tester.html#b5">02813</a>   <font class="keywordtype">void</font> Tester&lt;Input,Output, State&gt;::ExecuteMovesChoice()<font class="keyword"></font>
02814 <font class="keyword">  </font>{
02815     <font class="keywordflow">if</font> (sub_choice &gt; 0)
02816       move_testers[sub_choice-1]-&gt;RunTestMenu(test_state);
02817   }
02818 
02822   template &lt;class Input, class Output, class State&gt;
<a name="l02823"></a><a class="code" href="class_easylocal__Tester.html#b6">02823</a>   <font class="keywordtype">void</font> Tester&lt;Input,Output, State&gt;::ExecuteRunChoice()<font class="keyword"></font>
02824 <font class="keyword">  </font>{
02825     <font class="keywordflow">if</font> (sub_choice &gt; 0)
02826       {
02827         runners[sub_choice-1]-&gt;ReadParameters();
02828         runners[sub_choice-1]-&gt;SetCurrentState(test_state);
02829         clock_t start_t = clock();
02830         runners[sub_choice-1]-&gt;Go();
02831         clock_t end_t = clock();
02832         <font class="keywordtype">double</font> eltime = (end_t - start_t)/(<font class="keywordtype">double</font>)CLOCKS_PER_SEC;
02833         test_state = runners[sub_choice-1]-&gt;GetBestState();
02834         p_om-&gt;OutputState(test_state,out);
02835         std::cout &lt;&lt; <font class="stringliteral">"CURRENT SOLUTION "</font> &lt;&lt; std::endl &lt;&lt; out &lt;&lt; std::endl;
02836         std::cout &lt;&lt; <font class="stringliteral">"CURRENT COST : "</font> &lt;&lt; runners[sub_choice-1]-&gt;BestStateCost() &lt;&lt; std::endl;
02837         std::cout &lt;&lt; <font class="stringliteral">"ELAPSED TIME : "</font> &lt;&lt; eltime &lt;&lt; <font class="stringliteral">"s"</font> &lt;&lt; std::endl;
02838       }
02839   }
02840 } <font class="comment">// end of namespace easylocal</font>
</div></pre>      </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td><hr>
        <span class="mark">Go to:</span> the <a href="index.html">Main Page</a> of the documentation.
      </td>
    </tr>
  </tbody>
</table>
</body>
</html>
